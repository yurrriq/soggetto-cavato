<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span></span><span>
</span><a name="line-2"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-pragma">{-#  LANGUAGE FlexibleInstances, TypeSynonymInstances  #-}</span><span></span><span>
</span><a name="line-3"></a><span></span><span>
</span><a name="line-4"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Euterpea</span><span class="hs-operator">.</span><span class="hs-identifier">Music</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-5"></a><span></span><span>
</span><a name="line-6"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-operator">:+:</span><span class="hs-special">,</span><span> </span><span class="hs-operator">:=:</span><span></span><span>
</span><a name="line-7"></a><span></span><span>
</span><a name="line-8"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><a name="AbsPitch"><a href="Euterpea.Music.html#AbsPitch"><span class="hs-identifier">AbsPitch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span></span><span>
</span><a name="line-9"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><a name="Octave"><a href="Euterpea.Music.html#Octave"><span class="hs-identifier">Octave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span></span><span>
</span><a name="line-10"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><a name="Pitch"><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier">Pitch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#PitchClass"><span class="hs-identifier hs-type">PitchClass</span></a><span class="hs-special">,</span><span> </span><a href="Euterpea.Music.html#Octave"><span class="hs-identifier hs-type">Octave</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-11"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><a name="Dur"><a href="Euterpea.Music.html#Dur"><span class="hs-identifier">Dur</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Rational</span><span></span><span>
</span><a name="line-12"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="PitchClass"><a href="Euterpea.Music.html#PitchClass"><span class="hs-identifier">PitchClass</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a name="Cff"><a href="Euterpea.Music.html#Cff"><span class="hs-identifier">Cff</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Cf"><a href="Euterpea.Music.html#Cf"><span class="hs-identifier">Cf</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="C"><a href="Euterpea.Music.html#C"><span class="hs-identifier">C</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Dff"><a href="Euterpea.Music.html#Dff"><span class="hs-identifier">Dff</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Cs"><a href="Euterpea.Music.html#Cs"><span class="hs-identifier">Cs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Df"><a href="Euterpea.Music.html#Df"><span class="hs-identifier">Df</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Css"><a href="Euterpea.Music.html#Css"><span class="hs-identifier">Css</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="D"><a href="Euterpea.Music.html#D"><span class="hs-identifier">D</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Eff"><a href="Euterpea.Music.html#Eff"><span class="hs-identifier">Eff</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Ds"><a href="Euterpea.Music.html#Ds"><span class="hs-identifier">Ds</span></a></a><span> </span><span>
</span><a name="line-13"></a><span class="hs-operator">&gt;</span><span>                  </span><span class="hs-glyph">|</span><span>  </span><a name="Ef"><a href="Euterpea.Music.html#Ef"><span class="hs-identifier">Ef</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Fff"><a href="Euterpea.Music.html#Fff"><span class="hs-identifier">Fff</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Dss"><a href="Euterpea.Music.html#Dss"><span class="hs-identifier">Dss</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="E"><a href="Euterpea.Music.html#E"><span class="hs-identifier">E</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Ff"><a href="Euterpea.Music.html#Ff"><span class="hs-identifier">Ff</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Es"><a href="Euterpea.Music.html#Es"><span class="hs-identifier">Es</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="F"><a href="Euterpea.Music.html#F"><span class="hs-identifier">F</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Gff"><a href="Euterpea.Music.html#Gff"><span class="hs-identifier">Gff</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Ess"><a href="Euterpea.Music.html#Ess"><span class="hs-identifier">Ess</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Fs"><a href="Euterpea.Music.html#Fs"><span class="hs-identifier">Fs</span></a></a><span></span><span>
</span><a name="line-14"></a><span class="hs-operator">&gt;</span><span>                  </span><span class="hs-glyph">|</span><span>  </span><a name="Gf"><a href="Euterpea.Music.html#Gf"><span class="hs-identifier">Gf</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Fss"><a href="Euterpea.Music.html#Fss"><span class="hs-identifier">Fss</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="G"><a href="Euterpea.Music.html#G"><span class="hs-identifier">G</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Aff"><a href="Euterpea.Music.html#Aff"><span class="hs-identifier">Aff</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Gs"><a href="Euterpea.Music.html#Gs"><span class="hs-identifier">Gs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Af"><a href="Euterpea.Music.html#Af"><span class="hs-identifier">Af</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Gss"><a href="Euterpea.Music.html#Gss"><span class="hs-identifier">Gss</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="A"><a href="Euterpea.Music.html#A"><span class="hs-identifier">A</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Bff"><a href="Euterpea.Music.html#Bff"><span class="hs-identifier">Bff</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="As"><a href="Euterpea.Music.html#As"><span class="hs-identifier">As</span></a></a><span> </span><span>
</span><a name="line-15"></a><span class="hs-operator">&gt;</span><span>                  </span><span class="hs-glyph">|</span><span>  </span><a name="Bf"><a href="Euterpea.Music.html#Bf"><span class="hs-identifier">Bf</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Ass"><a href="Euterpea.Music.html#Ass"><span class="hs-identifier">Ass</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="B"><a href="Euterpea.Music.html#B"><span class="hs-identifier">B</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Bs"><a href="Euterpea.Music.html#Bs"><span class="hs-identifier">Bs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Bss"><a href="Euterpea.Music.html#Bss"><span class="hs-identifier">Bss</span></a></a><span></span><span>
</span><a name="line-16"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-17"></a><span></span><span>
</span><a name="line-18"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="Primitive"><a href="Euterpea.Music.html#Primitive"><span class="hs-identifier">Primitive</span></a></a><span> </span><a name="local-6989586621679030230"><a href="#local-6989586621679030230"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a name="Note"><a href="Euterpea.Music.html#Note"><span class="hs-identifier">Note</span></a></a><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span> </span><a href="#local-6989586621679030230"><span class="hs-identifier hs-type">a</span></a><span>        </span><span>
</span><a name="line-19"></a><span class="hs-operator">&gt;</span><span>                   </span><span class="hs-glyph">|</span><span>  </span><a name="Rest"><a href="Euterpea.Music.html#Rest"><span class="hs-identifier">Rest</span></a></a><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span>          </span><span>
</span><a name="line-20"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-21"></a><span></span><span>
</span><a name="line-22"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="Music"><a href="Euterpea.Music.html#Music"><span class="hs-identifier">Music</span></a></a><span> </span><a name="local-6989586621679030229"><a href="#local-6989586621679030229"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-23"></a><span class="hs-operator">&gt;</span><span>        </span><a name="Prim"><a href="Euterpea.Music.html#Prim"><span class="hs-identifier">Prim</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a><span> </span><a href="#local-6989586621679030229"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>               </span><span class="hs-comment">--  primitive value </span><span>
</span><a name="line-24"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span>  </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030229"><span class="hs-identifier hs-type">a</span></a><span> </span><a name="%3A%2B%3A"><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator">:+:</span></a></a><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030229"><span class="hs-identifier hs-type">a</span></a><span>              </span><span class="hs-comment">--  sequential composition</span><span>
</span><a name="line-25"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span>  </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030229"><span class="hs-identifier hs-type">a</span></a><span> </span><a name="%3A%3D%3A"><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator">:=:</span></a></a><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030229"><span class="hs-identifier hs-type">a</span></a><span>              </span><span class="hs-comment">--  parallel composition</span><span>
</span><a name="line-26"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span>  </span><a name="Modify"><a href="Euterpea.Music.html#Modify"><span class="hs-identifier">Modify</span></a></a><span> </span><a href="Euterpea.Music.html#Control"><span class="hs-identifier hs-type">Control</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030229"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>         </span><span class="hs-comment">--  modifier</span><span>
</span><a name="line-27"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-28"></a><span></span><span>
</span><a name="line-29"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="Control"><a href="Euterpea.Music.html#Control"><span class="hs-identifier">Control</span></a></a><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-30"></a><span class="hs-operator">&gt;</span><span>           </span><a name="Tempo"><a href="Euterpea.Music.html#Tempo"><span class="hs-identifier">Tempo</span></a></a><span>       </span><span class="hs-identifier hs-type">Rational</span><span>           </span><span class="hs-comment">--  scale the tempo</span><span>
</span><a name="line-31"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-glyph">|</span><span>  </span><a name="Transpose"><a href="Euterpea.Music.html#Transpose"><span class="hs-identifier">Transpose</span></a></a><span>   </span><a href="Euterpea.Music.html#AbsPitch"><span class="hs-identifier hs-type">AbsPitch</span></a><span>           </span><span class="hs-comment">--  transposition</span><span>
</span><a name="line-32"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-glyph">|</span><span>  </span><a name="Instrument"><a href="Euterpea.Music.html#Instrument"><span class="hs-identifier">Instrument</span></a></a><span>  </span><a href="Euterpea.Music.html#InstrumentName"><span class="hs-identifier hs-type">InstrumentName</span></a><span>     </span><span class="hs-comment">--  instrument label</span><span>
</span><a name="line-33"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-glyph">|</span><span>  </span><a name="Phrase"><a href="Euterpea.Music.html#Phrase"><span class="hs-identifier">Phrase</span></a></a><span>      </span><span class="hs-special">[</span><a href="Euterpea.Music.html#PhraseAttribute"><span class="hs-identifier hs-type">PhraseAttribute</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">--  phrase attributes</span><span>
</span><a name="line-34"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-glyph">|</span><span>  </span><a name="KeySig"><a href="Euterpea.Music.html#KeySig"><span class="hs-identifier">KeySig</span></a></a><span>      </span><a href="Euterpea.Music.html#PitchClass"><span class="hs-identifier hs-type">PitchClass</span></a><span> </span><a href="Euterpea.Music.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span>    </span><span class="hs-comment">--  key signature and mode</span><span>
</span><a name="line-35"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-glyph">|</span><span>  </span><a name="Custom"><a href="Euterpea.Music.html#Custom"><span class="hs-identifier">Custom</span></a></a><span>      </span><span class="hs-identifier hs-type">String</span><span>			   </span><span class="hs-comment">--  for user-specified controls</span><span>
</span><a name="line-36"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-37"></a><span></span><span>
</span><a name="line-38"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="Mode"><a href="Euterpea.Music.html#Mode"><span class="hs-identifier">Mode</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a name="Major"><a href="Euterpea.Music.html#Major"><span class="hs-identifier">Major</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Minor"><a href="Euterpea.Music.html#Minor"><span class="hs-identifier">Minor</span></a></a><span> </span><span>
</span><a name="line-39"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-40"></a><span></span><span>
</span><a name="line-41"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="InstrumentName"><a href="Euterpea.Music.html#InstrumentName"><span class="hs-identifier">InstrumentName</span></a></a><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-42"></a><span class="hs-operator">&gt;</span><span>      </span><a name="AcousticGrandPiano"><a href="Euterpea.Music.html#AcousticGrandPiano"><span class="hs-identifier">AcousticGrandPiano</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><a name="BrightAcousticPiano"><a href="Euterpea.Music.html#BrightAcousticPiano"><span class="hs-identifier">BrightAcousticPiano</span></a></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ElectricGrandPiano"><a href="Euterpea.Music.html#ElectricGrandPiano"><span class="hs-identifier">ElectricGrandPiano</span></a></a><span></span><span>
</span><a name="line-43"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="HonkyTonkPiano"><a href="Euterpea.Music.html#HonkyTonkPiano"><span class="hs-identifier">HonkyTonkPiano</span></a></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="RhodesPiano"><a href="Euterpea.Music.html#RhodesPiano"><span class="hs-identifier">RhodesPiano</span></a></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="ChorusedPiano"><a href="Euterpea.Music.html#ChorusedPiano"><span class="hs-identifier">ChorusedPiano</span></a></a><span></span><span>
</span><a name="line-44"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Harpsichord"><a href="Euterpea.Music.html#Harpsichord"><span class="hs-identifier">Harpsichord</span></a></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="Clavinet"><a href="Euterpea.Music.html#Clavinet"><span class="hs-identifier">Clavinet</span></a></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Celesta"><a href="Euterpea.Music.html#Celesta"><span class="hs-identifier">Celesta</span></a></a><span> </span><span>
</span><a name="line-45"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Glockenspiel"><a href="Euterpea.Music.html#Glockenspiel"><span class="hs-identifier">Glockenspiel</span></a></a><span>           </span><span class="hs-glyph">|</span><span> </span><a name="MusicBox"><a href="Euterpea.Music.html#MusicBox"><span class="hs-identifier">MusicBox</span></a></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Vibraphone"><a href="Euterpea.Music.html#Vibraphone"><span class="hs-identifier">Vibraphone</span></a></a><span>  </span><span>
</span><a name="line-46"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Marimba"><a href="Euterpea.Music.html#Marimba"><span class="hs-identifier">Marimba</span></a></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Xylophone"><a href="Euterpea.Music.html#Xylophone"><span class="hs-identifier">Xylophone</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="TubularBells"><a href="Euterpea.Music.html#TubularBells"><span class="hs-identifier">TubularBells</span></a></a><span></span><span>
</span><a name="line-47"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Dulcimer"><a href="Euterpea.Music.html#Dulcimer"><span class="hs-identifier">Dulcimer</span></a></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="HammondOrgan"><a href="Euterpea.Music.html#HammondOrgan"><span class="hs-identifier">HammondOrgan</span></a></a><span>           </span><span class="hs-glyph">|</span><span> </span><a name="PercussiveOrgan"><a href="Euterpea.Music.html#PercussiveOrgan"><span class="hs-identifier">PercussiveOrgan</span></a></a><span> </span><span>
</span><a name="line-48"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="RockOrgan"><a href="Euterpea.Music.html#RockOrgan"><span class="hs-identifier">RockOrgan</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="ChurchOrgan"><a href="Euterpea.Music.html#ChurchOrgan"><span class="hs-identifier">ChurchOrgan</span></a></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="ReedOrgan"><a href="Euterpea.Music.html#ReedOrgan"><span class="hs-identifier">ReedOrgan</span></a></a><span></span><span>
</span><a name="line-49"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Accordion"><a href="Euterpea.Music.html#Accordion"><span class="hs-identifier">Accordion</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="Harmonica"><a href="Euterpea.Music.html#Harmonica"><span class="hs-identifier">Harmonica</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="TangoAccordion"><a href="Euterpea.Music.html#TangoAccordion"><span class="hs-identifier">TangoAccordion</span></a></a><span></span><span>
</span><a name="line-50"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="AcousticGuitarNylon"><a href="Euterpea.Music.html#AcousticGuitarNylon"><span class="hs-identifier">AcousticGuitarNylon</span></a></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="AcousticGuitarSteel"><a href="Euterpea.Music.html#AcousticGuitarSteel"><span class="hs-identifier">AcousticGuitarSteel</span></a></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ElectricGuitarJazz"><a href="Euterpea.Music.html#ElectricGuitarJazz"><span class="hs-identifier">ElectricGuitarJazz</span></a></a><span></span><span>
</span><a name="line-51"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="ElectricGuitarClean"><a href="Euterpea.Music.html#ElectricGuitarClean"><span class="hs-identifier">ElectricGuitarClean</span></a></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ElectricGuitarMuted"><a href="Euterpea.Music.html#ElectricGuitarMuted"><span class="hs-identifier">ElectricGuitarMuted</span></a></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="OverdrivenGuitar"><a href="Euterpea.Music.html#OverdrivenGuitar"><span class="hs-identifier">OverdrivenGuitar</span></a></a><span></span><span>
</span><a name="line-52"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="DistortionGuitar"><a href="Euterpea.Music.html#DistortionGuitar"><span class="hs-identifier">DistortionGuitar</span></a></a><span>       </span><span class="hs-glyph">|</span><span> </span><a name="GuitarHarmonics"><a href="Euterpea.Music.html#GuitarHarmonics"><span class="hs-identifier">GuitarHarmonics</span></a></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="AcousticBass"><a href="Euterpea.Music.html#AcousticBass"><span class="hs-identifier">AcousticBass</span></a></a><span></span><span>
</span><a name="line-53"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="ElectricBassFingered"><a href="Euterpea.Music.html#ElectricBassFingered"><span class="hs-identifier">ElectricBassFingered</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="ElectricBassPicked"><a href="Euterpea.Music.html#ElectricBassPicked"><span class="hs-identifier">ElectricBassPicked</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><a name="FretlessBass"><a href="Euterpea.Music.html#FretlessBass"><span class="hs-identifier">FretlessBass</span></a></a><span></span><span>
</span><a name="line-54"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="SlapBass1"><a href="Euterpea.Music.html#SlapBass1"><span class="hs-identifier">SlapBass1</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="SlapBass2"><a href="Euterpea.Music.html#SlapBass2"><span class="hs-identifier">SlapBass2</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="SynthBass1"><a href="Euterpea.Music.html#SynthBass1"><span class="hs-identifier">SynthBass1</span></a></a><span>   </span><span>
</span><a name="line-55"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="SynthBass2"><a href="Euterpea.Music.html#SynthBass2"><span class="hs-identifier">SynthBass2</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="Violin"><a href="Euterpea.Music.html#Violin"><span class="hs-identifier">Violin</span></a></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="Viola"><a href="Euterpea.Music.html#Viola"><span class="hs-identifier">Viola</span></a></a><span>  </span><span>
</span><a name="line-56"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Cello"><a href="Euterpea.Music.html#Cello"><span class="hs-identifier">Cello</span></a></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="Contrabass"><a href="Euterpea.Music.html#Contrabass"><span class="hs-identifier">Contrabass</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="TremoloStrings"><a href="Euterpea.Music.html#TremoloStrings"><span class="hs-identifier">TremoloStrings</span></a></a><span></span><span>
</span><a name="line-57"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="PizzicatoStrings"><a href="Euterpea.Music.html#PizzicatoStrings"><span class="hs-identifier">PizzicatoStrings</span></a></a><span>       </span><span class="hs-glyph">|</span><span> </span><a name="OrchestralHarp"><a href="Euterpea.Music.html#OrchestralHarp"><span class="hs-identifier">OrchestralHarp</span></a></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="Timpani"><a href="Euterpea.Music.html#Timpani"><span class="hs-identifier">Timpani</span></a></a><span></span><span>
</span><a name="line-58"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="StringEnsemble1"><a href="Euterpea.Music.html#StringEnsemble1"><span class="hs-identifier">StringEnsemble1</span></a></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="StringEnsemble2"><a href="Euterpea.Music.html#StringEnsemble2"><span class="hs-identifier">StringEnsemble2</span></a></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="SynthStrings1"><a href="Euterpea.Music.html#SynthStrings1"><span class="hs-identifier">SynthStrings1</span></a></a><span></span><span>
</span><a name="line-59"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="SynthStrings2"><a href="Euterpea.Music.html#SynthStrings2"><span class="hs-identifier">SynthStrings2</span></a></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="ChoirAahs"><a href="Euterpea.Music.html#ChoirAahs"><span class="hs-identifier">ChoirAahs</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="VoiceOohs"><a href="Euterpea.Music.html#VoiceOohs"><span class="hs-identifier">VoiceOohs</span></a></a><span></span><span>
</span><a name="line-60"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="SynthVoice"><a href="Euterpea.Music.html#SynthVoice"><span class="hs-identifier">SynthVoice</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="OrchestraHit"><a href="Euterpea.Music.html#OrchestraHit"><span class="hs-identifier">OrchestraHit</span></a></a><span>           </span><span class="hs-glyph">|</span><span> </span><a name="Trumpet"><a href="Euterpea.Music.html#Trumpet"><span class="hs-identifier">Trumpet</span></a></a><span></span><span>
</span><a name="line-61"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Trombone"><a href="Euterpea.Music.html#Trombone"><span class="hs-identifier">Trombone</span></a></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Tuba"><a href="Euterpea.Music.html#Tuba"><span class="hs-identifier">Tuba</span></a></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="MutedTrumpet"><a href="Euterpea.Music.html#MutedTrumpet"><span class="hs-identifier">MutedTrumpet</span></a></a><span></span><span>
</span><a name="line-62"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="FrenchHorn"><a href="Euterpea.Music.html#FrenchHorn"><span class="hs-identifier">FrenchHorn</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="BrassSection"><a href="Euterpea.Music.html#BrassSection"><span class="hs-identifier">BrassSection</span></a></a><span>           </span><span class="hs-glyph">|</span><span> </span><a name="SynthBrass1"><a href="Euterpea.Music.html#SynthBrass1"><span class="hs-identifier">SynthBrass1</span></a></a><span></span><span>
</span><a name="line-63"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="SynthBrass2"><a href="Euterpea.Music.html#SynthBrass2"><span class="hs-identifier">SynthBrass2</span></a></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="SopranoSax"><a href="Euterpea.Music.html#SopranoSax"><span class="hs-identifier">SopranoSax</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="AltoSax"><a href="Euterpea.Music.html#AltoSax"><span class="hs-identifier">AltoSax</span></a></a><span> </span><span>
</span><a name="line-64"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="TenorSax"><a href="Euterpea.Music.html#TenorSax"><span class="hs-identifier">TenorSax</span></a></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="BaritoneSax"><a href="Euterpea.Music.html#BaritoneSax"><span class="hs-identifier">BaritoneSax</span></a></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="Oboe"><a href="Euterpea.Music.html#Oboe"><span class="hs-identifier">Oboe</span></a></a><span>  </span><span>
</span><a name="line-65"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Bassoon"><a href="Euterpea.Music.html#Bassoon"><span class="hs-identifier">Bassoon</span></a></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="EnglishHorn"><a href="Euterpea.Music.html#EnglishHorn"><span class="hs-identifier">EnglishHorn</span></a></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="Clarinet"><a href="Euterpea.Music.html#Clarinet"><span class="hs-identifier">Clarinet</span></a></a><span></span><span>
</span><a name="line-66"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Piccolo"><a href="Euterpea.Music.html#Piccolo"><span class="hs-identifier">Piccolo</span></a></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Flute"><a href="Euterpea.Music.html#Flute"><span class="hs-identifier">Flute</span></a></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="Recorder"><a href="Euterpea.Music.html#Recorder"><span class="hs-identifier">Recorder</span></a></a><span></span><span>
</span><a name="line-67"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="PanFlute"><a href="Euterpea.Music.html#PanFlute"><span class="hs-identifier">PanFlute</span></a></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="BlownBottle"><a href="Euterpea.Music.html#BlownBottle"><span class="hs-identifier">BlownBottle</span></a></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="Shakuhachi"><a href="Euterpea.Music.html#Shakuhachi"><span class="hs-identifier">Shakuhachi</span></a></a><span></span><span>
</span><a name="line-68"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Whistle"><a href="Euterpea.Music.html#Whistle"><span class="hs-identifier">Whistle</span></a></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Ocarina"><a href="Euterpea.Music.html#Ocarina"><span class="hs-identifier">Ocarina</span></a></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Lead1Square"><a href="Euterpea.Music.html#Lead1Square"><span class="hs-identifier">Lead1Square</span></a></a><span></span><span>
</span><a name="line-69"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Lead2Sawtooth"><a href="Euterpea.Music.html#Lead2Sawtooth"><span class="hs-identifier">Lead2Sawtooth</span></a></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="Lead3Calliope"><a href="Euterpea.Music.html#Lead3Calliope"><span class="hs-identifier">Lead3Calliope</span></a></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="Lead4Chiff"><a href="Euterpea.Music.html#Lead4Chiff"><span class="hs-identifier">Lead4Chiff</span></a></a><span></span><span>
</span><a name="line-70"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Lead5Charang"><a href="Euterpea.Music.html#Lead5Charang"><span class="hs-identifier">Lead5Charang</span></a></a><span>           </span><span class="hs-glyph">|</span><span> </span><a name="Lead6Voice"><a href="Euterpea.Music.html#Lead6Voice"><span class="hs-identifier">Lead6Voice</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="Lead7Fifths"><a href="Euterpea.Music.html#Lead7Fifths"><span class="hs-identifier">Lead7Fifths</span></a></a><span></span><span>
</span><a name="line-71"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Lead8BassLead"><a href="Euterpea.Music.html#Lead8BassLead"><span class="hs-identifier">Lead8BassLead</span></a></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="Pad1NewAge"><a href="Euterpea.Music.html#Pad1NewAge"><span class="hs-identifier">Pad1NewAge</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="Pad2Warm"><a href="Euterpea.Music.html#Pad2Warm"><span class="hs-identifier">Pad2Warm</span></a></a><span></span><span>
</span><a name="line-72"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Pad3Polysynth"><a href="Euterpea.Music.html#Pad3Polysynth"><span class="hs-identifier">Pad3Polysynth</span></a></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="Pad4Choir"><a href="Euterpea.Music.html#Pad4Choir"><span class="hs-identifier">Pad4Choir</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="Pad5Bowed"><a href="Euterpea.Music.html#Pad5Bowed"><span class="hs-identifier">Pad5Bowed</span></a></a><span></span><span>
</span><a name="line-73"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Pad6Metallic"><a href="Euterpea.Music.html#Pad6Metallic"><span class="hs-identifier">Pad6Metallic</span></a></a><span>           </span><span class="hs-glyph">|</span><span> </span><a name="Pad7Halo"><a href="Euterpea.Music.html#Pad7Halo"><span class="hs-identifier">Pad7Halo</span></a></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Pad8Sweep"><a href="Euterpea.Music.html#Pad8Sweep"><span class="hs-identifier">Pad8Sweep</span></a></a><span></span><span>
</span><a name="line-74"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="FX1Train"><a href="Euterpea.Music.html#FX1Train"><span class="hs-identifier">FX1Train</span></a></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="FX2Soundtrack"><a href="Euterpea.Music.html#FX2Soundtrack"><span class="hs-identifier">FX2Soundtrack</span></a></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="FX3Crystal"><a href="Euterpea.Music.html#FX3Crystal"><span class="hs-identifier">FX3Crystal</span></a></a><span></span><span>
</span><a name="line-75"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="FX4Atmosphere"><a href="Euterpea.Music.html#FX4Atmosphere"><span class="hs-identifier">FX4Atmosphere</span></a></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="FX5Brightness"><a href="Euterpea.Music.html#FX5Brightness"><span class="hs-identifier">FX5Brightness</span></a></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="FX6Goblins"><a href="Euterpea.Music.html#FX6Goblins"><span class="hs-identifier">FX6Goblins</span></a></a><span></span><span>
</span><a name="line-76"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="FX7Echoes"><a href="Euterpea.Music.html#FX7Echoes"><span class="hs-identifier">FX7Echoes</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="FX8SciFi"><a href="Euterpea.Music.html#FX8SciFi"><span class="hs-identifier">FX8SciFi</span></a></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Sitar"><a href="Euterpea.Music.html#Sitar"><span class="hs-identifier">Sitar</span></a></a><span></span><span>
</span><a name="line-77"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Banjo"><a href="Euterpea.Music.html#Banjo"><span class="hs-identifier">Banjo</span></a></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="Shamisen"><a href="Euterpea.Music.html#Shamisen"><span class="hs-identifier">Shamisen</span></a></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Koto"><a href="Euterpea.Music.html#Koto"><span class="hs-identifier">Koto</span></a></a><span></span><span>
</span><a name="line-78"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Kalimba"><a href="Euterpea.Music.html#Kalimba"><span class="hs-identifier">Kalimba</span></a></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Bagpipe"><a href="Euterpea.Music.html#Bagpipe"><span class="hs-identifier">Bagpipe</span></a></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Fiddle"><a href="Euterpea.Music.html#Fiddle"><span class="hs-identifier">Fiddle</span></a></a><span> </span><span>
</span><a name="line-79"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Shanai"><a href="Euterpea.Music.html#Shanai"><span class="hs-identifier">Shanai</span></a></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="TinkleBell"><a href="Euterpea.Music.html#TinkleBell"><span class="hs-identifier">TinkleBell</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="Agogo"><a href="Euterpea.Music.html#Agogo"><span class="hs-identifier">Agogo</span></a></a><span>  </span><span>
</span><a name="line-80"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="SteelDrums"><a href="Euterpea.Music.html#SteelDrums"><span class="hs-identifier">SteelDrums</span></a></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="Woodblock"><a href="Euterpea.Music.html#Woodblock"><span class="hs-identifier">Woodblock</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="TaikoDrum"><a href="Euterpea.Music.html#TaikoDrum"><span class="hs-identifier">TaikoDrum</span></a></a><span></span><span>
</span><a name="line-81"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="MelodicDrum"><a href="Euterpea.Music.html#MelodicDrum"><span class="hs-identifier">MelodicDrum</span></a></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="SynthDrum"><a href="Euterpea.Music.html#SynthDrum"><span class="hs-identifier">SynthDrum</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="ReverseCymbal"><a href="Euterpea.Music.html#ReverseCymbal"><span class="hs-identifier">ReverseCymbal</span></a></a><span></span><span>
</span><a name="line-82"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="GuitarFretNoise"><a href="Euterpea.Music.html#GuitarFretNoise"><span class="hs-identifier">GuitarFretNoise</span></a></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="BreathNoise"><a href="Euterpea.Music.html#BreathNoise"><span class="hs-identifier">BreathNoise</span></a></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="Seashore"><a href="Euterpea.Music.html#Seashore"><span class="hs-identifier">Seashore</span></a></a><span></span><span>
</span><a name="line-83"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="BirdTweet"><a href="Euterpea.Music.html#BirdTweet"><span class="hs-identifier">BirdTweet</span></a></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="TelephoneRing"><a href="Euterpea.Music.html#TelephoneRing"><span class="hs-identifier">TelephoneRing</span></a></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="Helicopter"><a href="Euterpea.Music.html#Helicopter"><span class="hs-identifier">Helicopter</span></a></a><span></span><span>
</span><a name="line-84"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="Applause"><a href="Euterpea.Music.html#Applause"><span class="hs-identifier">Applause</span></a></a><span>               </span><span class="hs-glyph">|</span><span> </span><a name="Gunshot"><a href="Euterpea.Music.html#Gunshot"><span class="hs-identifier">Gunshot</span></a></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Percussion"><a href="Euterpea.Music.html#Percussion"><span class="hs-identifier">Percussion</span></a></a><span></span><span>
</span><a name="line-85"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-glyph">|</span><span>  </span><a name="CustomInstrument"><a href="Euterpea.Music.html#CustomInstrument"><span class="hs-identifier">CustomInstrument</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span></span><span>
</span><a name="line-86"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-87"></a><span></span><span>
</span><a name="line-88"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="PhraseAttribute"><a href="Euterpea.Music.html#PhraseAttribute"><span class="hs-identifier">PhraseAttribute</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a name="Dyn"><a href="Euterpea.Music.html#Dyn"><span class="hs-identifier">Dyn</span></a></a><span> </span><a href="Euterpea.Music.html#Dynamic"><span class="hs-identifier hs-type">Dynamic</span></a><span></span><span>
</span><a name="line-89"></a><span class="hs-operator">&gt;</span><span>                       </span><span class="hs-glyph">|</span><span>  </span><a name="Tmp"><a href="Euterpea.Music.html#Tmp"><span class="hs-identifier">Tmp</span></a></a><span> </span><a href="Euterpea.Music.html#Tempo"><span class="hs-identifier hs-type">Tempo</span></a><span></span><span>
</span><a name="line-90"></a><span class="hs-operator">&gt;</span><span>                       </span><span class="hs-glyph">|</span><span>  </span><a name="Art"><a href="Euterpea.Music.html#Art"><span class="hs-identifier">Art</span></a></a><span> </span><a href="Euterpea.Music.html#Articulation"><span class="hs-identifier hs-type">Articulation</span></a><span></span><span>
</span><a name="line-91"></a><span class="hs-operator">&gt;</span><span>                       </span><span class="hs-glyph">|</span><span>  </span><a name="Orn"><a href="Euterpea.Music.html#Orn"><span class="hs-identifier">Orn</span></a></a><span> </span><a href="Euterpea.Music.html#Ornament"><span class="hs-identifier hs-type">Ornament</span></a><span></span><span>
</span><a name="line-92"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-93"></a><span></span><span>
</span><a name="line-94"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="Dynamic"><a href="Euterpea.Music.html#Dynamic"><span class="hs-identifier">Dynamic</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a name="Accent"><a href="Euterpea.Music.html#Accent"><span class="hs-identifier">Accent</span></a></a><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="Crescendo"><a href="Euterpea.Music.html#Crescendo"><span class="hs-identifier">Crescendo</span></a></a><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="Diminuendo"><a href="Euterpea.Music.html#Diminuendo"><span class="hs-identifier">Diminuendo</span></a></a><span> </span><span class="hs-identifier hs-type">Rational</span><span></span><span>
</span><a name="line-95"></a><span class="hs-operator">&gt;</span><span>               </span><span class="hs-glyph">|</span><span>  </span><a name="StdLoudness"><a href="Euterpea.Music.html#StdLoudness"><span class="hs-identifier">StdLoudness</span></a></a><span> </span><a href="Euterpea.Music.html#StdLoudness"><span class="hs-identifier hs-type">StdLoudness</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Loudness"><a href="Euterpea.Music.html#Loudness"><span class="hs-identifier">Loudness</span></a></a><span> </span><span class="hs-identifier hs-type">Rational</span><span></span><span>
</span><a name="line-96"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-97"></a><span></span><span>
</span><a name="line-98"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="StdLoudness"><a href="Euterpea.Music.html#StdLoudness"><span class="hs-identifier">StdLoudness</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="PPP"><a href="Euterpea.Music.html#PPP"><span class="hs-identifier">PPP</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="PP"><a href="Euterpea.Music.html#PP"><span class="hs-identifier">PP</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="P"><a href="Euterpea.Music.html#P"><span class="hs-identifier">P</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="MP"><a href="Euterpea.Music.html#MP"><span class="hs-identifier">MP</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="SF"><a href="Euterpea.Music.html#SF"><span class="hs-identifier">SF</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="MF"><a href="Euterpea.Music.html#MF"><span class="hs-identifier">MF</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NF"><a href="Euterpea.Music.html#NF"><span class="hs-identifier">NF</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="FF"><a href="Euterpea.Music.html#FF"><span class="hs-identifier">FF</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="FFF"><a href="Euterpea.Music.html#FFF"><span class="hs-identifier">FFF</span></a></a><span></span><span>
</span><a name="line-99"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-100"></a><span></span><span>
</span><a name="line-101"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="Tempo"><a href="Euterpea.Music.html#Tempo"><span class="hs-identifier">Tempo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Ritardando"><a href="Euterpea.Music.html#Ritardando"><span class="hs-identifier">Ritardando</span></a></a><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="Accelerando"><a href="Euterpea.Music.html#Accelerando"><span class="hs-identifier">Accelerando</span></a></a><span> </span><span class="hs-identifier hs-type">Rational</span><span></span><span>
</span><a name="line-102"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-103"></a><span></span><span>
</span><a name="line-104"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="Articulation"><a href="Euterpea.Music.html#Articulation"><span class="hs-identifier">Articulation</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a name="Staccato"><a href="Euterpea.Music.html#Staccato"><span class="hs-identifier">Staccato</span></a></a><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="Legato"><a href="Euterpea.Music.html#Legato"><span class="hs-identifier">Legato</span></a></a><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="Slurred"><a href="Euterpea.Music.html#Slurred"><span class="hs-identifier">Slurred</span></a></a><span> </span><span class="hs-identifier hs-type">Rational</span><span></span><span>
</span><a name="line-105"></a><span class="hs-operator">&gt;</span><span>                    </span><span class="hs-glyph">|</span><span>  </span><a name="Tenuto"><a href="Euterpea.Music.html#Tenuto"><span class="hs-identifier">Tenuto</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Marcato"><a href="Euterpea.Music.html#Marcato"><span class="hs-identifier">Marcato</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Pedal"><a href="Euterpea.Music.html#Pedal"><span class="hs-identifier">Pedal</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Fermata"><a href="Euterpea.Music.html#Fermata"><span class="hs-identifier">Fermata</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="FermataDown"><a href="Euterpea.Music.html#FermataDown"><span class="hs-identifier">FermataDown</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Breath"><a href="Euterpea.Music.html#Breath"><span class="hs-identifier">Breath</span></a></a><span></span><span>
</span><a name="line-106"></a><span class="hs-operator">&gt;</span><span>                    </span><span class="hs-glyph">|</span><span>  </span><a name="DownBow"><a href="Euterpea.Music.html#DownBow"><span class="hs-identifier">DownBow</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="UpBow"><a href="Euterpea.Music.html#UpBow"><span class="hs-identifier">UpBow</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Harmonic"><a href="Euterpea.Music.html#Harmonic"><span class="hs-identifier">Harmonic</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Pizzicato"><a href="Euterpea.Music.html#Pizzicato"><span class="hs-identifier">Pizzicato</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="LeftPizz"><a href="Euterpea.Music.html#LeftPizz"><span class="hs-identifier">LeftPizz</span></a></a><span></span><span>
</span><a name="line-107"></a><span class="hs-operator">&gt;</span><span>                    </span><span class="hs-glyph">|</span><span>  </span><a name="BartokPizz"><a href="Euterpea.Music.html#BartokPizz"><span class="hs-identifier">BartokPizz</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Swell"><a href="Euterpea.Music.html#Swell"><span class="hs-identifier">Swell</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Wedge"><a href="Euterpea.Music.html#Wedge"><span class="hs-identifier">Wedge</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Thumb"><a href="Euterpea.Music.html#Thumb"><span class="hs-identifier">Thumb</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Stopped"><a href="Euterpea.Music.html#Stopped"><span class="hs-identifier">Stopped</span></a></a><span></span><span>
</span><a name="line-108"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-109"></a><span></span><span>
</span><a name="line-110"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="Ornament"><a href="Euterpea.Music.html#Ornament"><span class="hs-identifier">Ornament</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a name="Trill"><a href="Euterpea.Music.html#Trill"><span class="hs-identifier">Trill</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Mordent"><a href="Euterpea.Music.html#Mordent"><span class="hs-identifier">Mordent</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="InvMordent"><a href="Euterpea.Music.html#InvMordent"><span class="hs-identifier">InvMordent</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="DoubleMordent"><a href="Euterpea.Music.html#DoubleMordent"><span class="hs-identifier">DoubleMordent</span></a></a><span></span><span>
</span><a name="line-111"></a><span class="hs-operator">&gt;</span><span>                </span><span class="hs-glyph">|</span><span>  </span><a name="Turn"><a href="Euterpea.Music.html#Turn"><span class="hs-identifier">Turn</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="TrilledTurn"><a href="Euterpea.Music.html#TrilledTurn"><span class="hs-identifier">TrilledTurn</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ShortTrill"><a href="Euterpea.Music.html#ShortTrill"><span class="hs-identifier">ShortTrill</span></a></a><span></span><span>
</span><a name="line-112"></a><span class="hs-operator">&gt;</span><span>                </span><span class="hs-glyph">|</span><span>  </span><a name="Arpeggio"><a href="Euterpea.Music.html#Arpeggio"><span class="hs-identifier">Arpeggio</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ArpeggioUp"><a href="Euterpea.Music.html#ArpeggioUp"><span class="hs-identifier">ArpeggioUp</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ArpeggioDown"><a href="Euterpea.Music.html#ArpeggioDown"><span class="hs-identifier">ArpeggioDown</span></a></a><span></span><span>
</span><a name="line-113"></a><span class="hs-operator">&gt;</span><span>                </span><span class="hs-glyph">|</span><span>  </span><a name="Instruction"><a href="Euterpea.Music.html#Instruction"><span class="hs-identifier">Instruction</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="Head"><a href="Euterpea.Music.html#Head"><span class="hs-identifier">Head</span></a></a><span> </span><a href="Euterpea.Music.html#NoteHead"><span class="hs-identifier hs-type">NoteHead</span></a><span></span><span>
</span><a name="line-114"></a><span class="hs-operator">&gt;</span><span>                </span><span class="hs-glyph">|</span><span>  </span><a name="DiatonicTrans"><a href="Euterpea.Music.html#DiatonicTrans"><span class="hs-identifier">DiatonicTrans</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span></span><span>
</span><a name="line-115"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-116"></a><span></span><span>
</span><a name="line-117"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="NoteHead"><a href="Euterpea.Music.html#NoteHead"><span class="hs-identifier">NoteHead</span></a></a><span>  </span><span class="hs-glyph">=</span><span>  </span><a name="DiamondHead"><a href="Euterpea.Music.html#DiamondHead"><span class="hs-identifier">DiamondHead</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="SquareHead"><a href="Euterpea.Music.html#SquareHead"><span class="hs-identifier">SquareHead</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="XHead"><a href="Euterpea.Music.html#XHead"><span class="hs-identifier">XHead</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="TriangleHead"><a href="Euterpea.Music.html#TriangleHead"><span class="hs-identifier">TriangleHead</span></a></a><span></span><span>
</span><a name="line-118"></a><span class="hs-operator">&gt;</span><span>                </span><span class="hs-glyph">|</span><span>  </span><a name="TremoloHead"><a href="Euterpea.Music.html#TremoloHead"><span class="hs-identifier">TremoloHead</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="SlashHead"><a href="Euterpea.Music.html#SlashHead"><span class="hs-identifier">SlashHead</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ArtHarmonic"><a href="Euterpea.Music.html#ArtHarmonic"><span class="hs-identifier">ArtHarmonic</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NoHead"><a href="Euterpea.Music.html#NoHead"><span class="hs-identifier">NoHead</span></a></a><span></span><span>
</span><a name="line-119"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-120"></a><span></span><span>
</span><a name="line-121"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><a name="Volume"><a href="Euterpea.Music.html#Volume"><span class="hs-identifier">Volume</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span></span><span>
</span><a name="line-122"></a><span></span><span>
</span><a name="line-123"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">addVolume</span><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Volume"><span class="hs-identifier hs-type">Volume</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#Volume"><span class="hs-identifier hs-type">Volume</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-124"></a><span class="hs-operator">&gt;</span><span> </span><a name="addVolume"><a href="Euterpea.Music.html#addVolume"><span class="hs-identifier">addVolume</span></a></a><span> </span><a name="local-6989586621679030954"><a href="#local-6989586621679030954"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679030955"><a href="#local-6989586621679030955"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030955"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><a href="#local-6989586621679030954"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-125"></a><span></span><span>
</span><a name="line-126"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="NoteAttribute"><a href="Euterpea.Music.html#NoteAttribute"><span class="hs-identifier">NoteAttribute</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-127"></a><span class="hs-operator">&gt;</span><span>         </span><a name="Volume"><a href="Euterpea.Music.html#Volume"><span class="hs-identifier">Volume</span></a></a><span>  </span><span class="hs-identifier hs-type">Int</span><span>   </span><span class="hs-comment">--  MIDI convention: 0=min, 127=max</span><span>
</span><a name="line-128"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="Fingering"><a href="Euterpea.Music.html#Fingering"><span class="hs-identifier">Fingering</span></a></a><span> </span><span class="hs-identifier hs-type">Integer</span><span></span><span>
</span><a name="line-129"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="Dynamics"><a href="Euterpea.Music.html#Dynamics"><span class="hs-identifier">Dynamics</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span></span><span>
</span><a name="line-130"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="Params"><a href="Euterpea.Music.html#Params"><span class="hs-identifier">Params</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-131"></a><span class="hs-operator">&gt;</span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-132"></a><span></span><span>
</span><a name="line-133"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><a name="Note1"><a href="Euterpea.Music.html#Note1"><span class="hs-identifier">Note1</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Euterpea.Music.html#NoteAttribute"><span class="hs-identifier hs-type">NoteAttribute</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-134"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><a name="Music1"><a href="Euterpea.Music.html#Music1"><span class="hs-identifier">Music1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Note1"><span class="hs-identifier hs-type">Note1</span></a><span></span><span>
</span><a name="line-135"></a><span></span><span>
</span><a name="line-136"></a><span></span><span>
</span><a name="line-137"></a><span class="hs-identifier">A</span><span> </span><span class="hs-identifier">new</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">class</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">allow</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">musical</span><span> </span><span class="hs-identifier">polymorphism</span><span> </span><span class="hs-identifier">that</span><span> </span><span class="hs-identifier">ultimately</span><span></span><span>
</span><a name="line-138"></a><span class="hs-identifier">must</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">converted</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">Music1</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">converted</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">MIDI</span><span> </span><span class="hs-identifier">format</span><span> </span><span class="hs-identifier">through</span><span></span><span>
</span><a name="line-139"></a><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">MEvent</span><span> </span><span class="hs-identifier">framework</span><span class="hs-operator">.</span><span></span><span>
</span><a name="line-140"></a><span></span><span>
</span><a name="line-141"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">class</span><span> </span><a name="ToMusic1"><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier">ToMusic1</span></a></a><span> </span><a name="local-6989586621679028826"><a href="#local-6989586621679028826"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-142"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-identifier">toMusic1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679028826"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music1"><span class="hs-identifier hs-type">Music1</span></a><span></span><span>
</span><a name="line-143"></a><span></span><span>
</span><a name="line-144"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-145"></a><span class="hs-operator">&gt;</span><span>     </span><a name="local-8214565720323798782"><a href="Euterpea.Music.html#toMusic1"><span class="hs-identifier">toMusic1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679032639"><a href="#local-6989586621679032639"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032639"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-146"></a><span></span><span>
</span><a name="line-147"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span class="hs-special">,</span><span> </span><a href="Euterpea.Music.html#Volume"><span class="hs-identifier hs-type">Volume</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-148"></a><span class="hs-operator">&gt;</span><span>     </span><a name="local-8214565720323798782"><a href="Euterpea.Music.html#toMusic1"><span class="hs-identifier">toMusic1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679032637"><a href="#local-6989586621679032637"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679032638"><a href="#local-6989586621679032638"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032637"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Euterpea.Music.html#Volume"><span class="hs-identifier hs-var">Volume</span></a><span> </span><a href="#local-6989586621679032638"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-149"></a><span></span><span>
</span><a name="line-150"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note1"><span class="hs-identifier hs-type">Note1</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-151"></a><span class="hs-operator">&gt;</span><span>     </span><a name="local-8214565720323798782"><a href="Euterpea.Music.html#toMusic1"><span class="hs-identifier">toMusic1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span></span><span>
</span><a name="line-152"></a><span></span><span>
</span><a name="line-153"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="Euterpea.Music.html#ToMusic1"><span class="hs-identifier hs-type">ToMusic1</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#AbsPitch"><span class="hs-identifier hs-type">AbsPitch</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-154"></a><span class="hs-operator">&gt;</span><span>     </span><a name="local-8214565720323798782"><a href="Euterpea.Music.html#toMusic1"><span class="hs-identifier">toMusic1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679032636"><a href="#local-6989586621679032636"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#pitch"><span class="hs-identifier hs-var">pitch</span></a><span> </span><a href="#local-6989586621679032636"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-155"></a><span></span><span>
</span><a name="line-156"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">note</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030953"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030953"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-157"></a><span class="hs-operator">&gt;</span><span> </span><a name="note"><a href="Euterpea.Music.html#note"><span class="hs-identifier">note</span></a></a><span> </span><a name="local-6989586621679030956"><a href="#local-6989586621679030956"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679030957"><a href="#local-6989586621679030957"><span class="hs-identifier">p</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><a href="#local-6989586621679030956"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679030957"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-158"></a><span></span><span>
</span><a name="line-159"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">rest</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030952"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-160"></a><span class="hs-operator">&gt;</span><span> </span><a name="rest"><a href="Euterpea.Music.html#rest"><span class="hs-identifier">rest</span></a></a><span> </span><a name="local-6989586621679030958"><a href="#local-6989586621679030958"><span class="hs-identifier">d</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><a href="#local-6989586621679030958"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-161"></a><span></span><span>
</span><a name="line-162"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">tempo</span><span>           </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030951"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030951"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-163"></a><span class="hs-operator">&gt;</span><span> </span><a name="tempo"><a href="Euterpea.Music.html#tempo"><span class="hs-identifier">tempo</span></a></a><span> </span><a name="local-6989586621679030959"><a href="#local-6989586621679030959"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679030960"><a href="#local-6989586621679030960"><span class="hs-identifier">m</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Tempo"><span class="hs-identifier hs-var">Tempo</span></a><span> </span><a href="#local-6989586621679030959"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030960"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-164"></a><span></span><span>
</span><a name="line-165"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">transpose</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#AbsPitch"><span class="hs-identifier hs-type">AbsPitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030950"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030950"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-166"></a><span class="hs-operator">&gt;</span><span> </span><a name="transpose"><a href="Euterpea.Music.html#transpose"><span class="hs-identifier">transpose</span></a></a><span> </span><a name="local-6989586621679030961"><a href="#local-6989586621679030961"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679030962"><a href="#local-6989586621679030962"><span class="hs-identifier">m</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Transpose"><span class="hs-identifier hs-var">Transpose</span></a><span> </span><a href="#local-6989586621679030961"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030962"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-167"></a><span></span><span>
</span><a name="line-168"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">instrument</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#InstrumentName"><span class="hs-identifier hs-type">InstrumentName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030949"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030949"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-169"></a><span class="hs-operator">&gt;</span><span> </span><a name="instrument"><a href="Euterpea.Music.html#instrument"><span class="hs-identifier">instrument</span></a></a><span> </span><a name="local-6989586621679030963"><a href="#local-6989586621679030963"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679030964"><a href="#local-6989586621679030964"><span class="hs-identifier">m</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Instrument"><span class="hs-identifier hs-var">Instrument</span></a><span> </span><a href="#local-6989586621679030963"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030964"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-170"></a><span></span><span>
</span><a name="line-171"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">phrase</span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Euterpea.Music.html#PhraseAttribute"><span class="hs-identifier hs-type">PhraseAttribute</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030948"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030948"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-172"></a><span class="hs-operator">&gt;</span><span> </span><a name="phrase"><a href="Euterpea.Music.html#phrase"><span class="hs-identifier">phrase</span></a></a><span> </span><a name="local-6989586621679030965"><a href="#local-6989586621679030965"><span class="hs-identifier">pa</span></a></a><span> </span><a name="local-6989586621679030966"><a href="#local-6989586621679030966"><span class="hs-identifier">m</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Phrase"><span class="hs-identifier hs-var">Phrase</span></a><span> </span><a href="#local-6989586621679030965"><span class="hs-identifier hs-var">pa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030966"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-173"></a><span></span><span>
</span><a name="line-174"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">keysig</span><span>          </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#PitchClass"><span class="hs-identifier hs-type">PitchClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Mode"><span class="hs-identifier hs-type">Mode</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030947"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030947"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-175"></a><span class="hs-operator">&gt;</span><span> </span><a name="keysig"><a href="Euterpea.Music.html#keysig"><span class="hs-identifier">keysig</span></a></a><span> </span><a name="local-6989586621679030967"><a href="#local-6989586621679030967"><span class="hs-identifier">pc</span></a></a><span> </span><a name="local-6989586621679030968"><a href="#local-6989586621679030968"><span class="hs-identifier">mo</span></a></a><span> </span><a name="local-6989586621679030969"><a href="#local-6989586621679030969"><span class="hs-identifier">m</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#KeySig"><span class="hs-identifier hs-var">KeySig</span></a><span> </span><a href="#local-6989586621679030967"><span class="hs-identifier hs-var">pc</span></a><span> </span><a href="#local-6989586621679030968"><span class="hs-identifier hs-var">mo</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030969"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-176"></a><span></span><span>
</span><a name="line-177"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cff</span><span class="hs-special">,</span><span class="hs-identifier">cf</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">cs</span><span class="hs-special">,</span><span class="hs-identifier">css</span><span class="hs-special">,</span><span class="hs-identifier">dff</span><span class="hs-special">,</span><span class="hs-identifier">df</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span class="hs-identifier">ds</span><span class="hs-special">,</span><span class="hs-identifier">dss</span><span class="hs-special">,</span><span class="hs-identifier">eff</span><span class="hs-special">,</span><span class="hs-identifier">ef</span><span class="hs-special">,</span><span class="hs-identifier">e</span><span class="hs-special">,</span><span class="hs-identifier">es</span><span class="hs-special">,</span><span class="hs-identifier">ess</span><span class="hs-special">,</span><span class="hs-identifier">fff</span><span class="hs-special">,</span><span class="hs-identifier">ff</span><span class="hs-special">,</span><span class="hs-identifier">f</span><span class="hs-special">,</span><span></span><span>
</span><a name="line-178"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-identifier">fs</span><span class="hs-special">,</span><span class="hs-identifier">fss</span><span class="hs-special">,</span><span class="hs-identifier">gff</span><span class="hs-special">,</span><span class="hs-identifier">gf</span><span class="hs-special">,</span><span class="hs-identifier">g</span><span class="hs-special">,</span><span class="hs-identifier">gs</span><span class="hs-special">,</span><span class="hs-identifier">gss</span><span class="hs-special">,</span><span class="hs-identifier">aff</span><span class="hs-special">,</span><span class="hs-identifier">af</span><span class="hs-special">,</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-keyword">as</span><span class="hs-special">,</span><span class="hs-identifier">ass</span><span class="hs-special">,</span><span class="hs-identifier">bff</span><span class="hs-special">,</span><span class="hs-identifier">bf</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">bs</span><span class="hs-special">,</span><span class="hs-identifier">bss</span><span> </span><span class="hs-glyph">::</span><span> </span><span>
</span><a name="line-179"></a><span class="hs-operator">&gt;</span><span>     </span><a href="Euterpea.Music.html#Octave"><span class="hs-identifier hs-type">Octave</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span></span><span>
</span><a name="line-180"></a><span></span><span>
</span><a name="line-181"></a><span class="hs-operator">&gt;</span><span> </span><a name="cff"><a href="Euterpea.Music.html#cff"><span class="hs-identifier">cff</span></a></a><span>  </span><a name="local-6989586621679030970"><a href="#local-6989586621679030970"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030971"><a href="#local-6989586621679030971"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030971"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Cff"><span class="hs-identifier hs-var">Cff</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679030970"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="cf"><a href="Euterpea.Music.html#cf"><span class="hs-identifier">cf</span></a></a><span>   </span><a name="local-6989586621679030972"><a href="#local-6989586621679030972"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030973"><a href="#local-6989586621679030973"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030973"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Cf"><span class="hs-identifier hs-var">Cf</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679030972"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-182"></a><span class="hs-operator">&gt;</span><span> </span><a name="c"><a href="Euterpea.Music.html#c"><span class="hs-identifier">c</span></a></a><span>    </span><a name="local-6989586621679030974"><a href="#local-6989586621679030974"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030975"><a href="#local-6989586621679030975"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030975"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#C"><span class="hs-identifier hs-var">C</span></a><span class="hs-special">,</span><span>    </span><a href="#local-6989586621679030974"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="cs"><a href="Euterpea.Music.html#cs"><span class="hs-identifier">cs</span></a></a><span>   </span><a name="local-6989586621679030976"><a href="#local-6989586621679030976"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030977"><a href="#local-6989586621679030977"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030977"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Cs"><span class="hs-identifier hs-var">Cs</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679030976"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-183"></a><span class="hs-operator">&gt;</span><span> </span><a name="css"><a href="Euterpea.Music.html#css"><span class="hs-identifier">css</span></a></a><span>  </span><a name="local-6989586621679030978"><a href="#local-6989586621679030978"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030979"><a href="#local-6989586621679030979"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030979"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Css"><span class="hs-identifier hs-var">Css</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679030978"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="dff"><a href="Euterpea.Music.html#dff"><span class="hs-identifier">dff</span></a></a><span>  </span><a name="local-6989586621679030980"><a href="#local-6989586621679030980"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030981"><a href="#local-6989586621679030981"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030981"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Dff"><span class="hs-identifier hs-var">Dff</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679030980"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-184"></a><span class="hs-operator">&gt;</span><span> </span><a name="df"><a href="Euterpea.Music.html#df"><span class="hs-identifier">df</span></a></a><span>   </span><a name="local-6989586621679030982"><a href="#local-6989586621679030982"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030983"><a href="#local-6989586621679030983"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030983"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Df"><span class="hs-identifier hs-var">Df</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679030982"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="d"><a href="Euterpea.Music.html#d"><span class="hs-identifier">d</span></a></a><span>    </span><a name="local-6989586621679030984"><a href="#local-6989586621679030984"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030985"><a href="#local-6989586621679030985"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030985"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#D"><span class="hs-identifier hs-var">D</span></a><span class="hs-special">,</span><span>    </span><a href="#local-6989586621679030984"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-185"></a><span class="hs-operator">&gt;</span><span> </span><a name="ds"><a href="Euterpea.Music.html#ds"><span class="hs-identifier">ds</span></a></a><span>   </span><a name="local-6989586621679030986"><a href="#local-6989586621679030986"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030987"><a href="#local-6989586621679030987"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030987"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Ds"><span class="hs-identifier hs-var">Ds</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679030986"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="dss"><a href="Euterpea.Music.html#dss"><span class="hs-identifier">dss</span></a></a><span>  </span><a name="local-6989586621679030988"><a href="#local-6989586621679030988"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030989"><a href="#local-6989586621679030989"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030989"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Dss"><span class="hs-identifier hs-var">Dss</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679030988"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-186"></a><span class="hs-operator">&gt;</span><span> </span><a name="eff"><a href="Euterpea.Music.html#eff"><span class="hs-identifier">eff</span></a></a><span>  </span><a name="local-6989586621679030990"><a href="#local-6989586621679030990"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030991"><a href="#local-6989586621679030991"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030991"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Eff"><span class="hs-identifier hs-var">Eff</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679030990"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="ef"><a href="Euterpea.Music.html#ef"><span class="hs-identifier">ef</span></a></a><span>   </span><a name="local-6989586621679030992"><a href="#local-6989586621679030992"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030993"><a href="#local-6989586621679030993"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030993"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Ef"><span class="hs-identifier hs-var">Ef</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679030992"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-187"></a><span class="hs-operator">&gt;</span><span> </span><a name="e"><a href="Euterpea.Music.html#e"><span class="hs-identifier">e</span></a></a><span>    </span><a name="local-6989586621679030994"><a href="#local-6989586621679030994"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030995"><a href="#local-6989586621679030995"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030995"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#E"><span class="hs-identifier hs-var">E</span></a><span class="hs-special">,</span><span>    </span><a href="#local-6989586621679030994"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="es"><a href="Euterpea.Music.html#es"><span class="hs-identifier">es</span></a></a><span>   </span><a name="local-6989586621679030996"><a href="#local-6989586621679030996"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030997"><a href="#local-6989586621679030997"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030997"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Es"><span class="hs-identifier hs-var">Es</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679030996"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-188"></a><span class="hs-operator">&gt;</span><span> </span><a name="ess"><a href="Euterpea.Music.html#ess"><span class="hs-identifier">ess</span></a></a><span>  </span><a name="local-6989586621679030998"><a href="#local-6989586621679030998"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679030999"><a href="#local-6989586621679030999"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679030999"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Ess"><span class="hs-identifier hs-var">Ess</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679030998"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="fff"><a href="Euterpea.Music.html#fff"><span class="hs-identifier">fff</span></a></a><span>  </span><a name="local-6989586621679031000"><a href="#local-6989586621679031000"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031001"><a href="#local-6989586621679031001"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031001"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Fff"><span class="hs-identifier hs-var">Fff</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679031000"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-189"></a><span class="hs-operator">&gt;</span><span> </span><a name="ff"><a href="Euterpea.Music.html#ff"><span class="hs-identifier">ff</span></a></a><span>   </span><a name="local-6989586621679031002"><a href="#local-6989586621679031002"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031003"><a href="#local-6989586621679031003"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031003"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Ff"><span class="hs-identifier hs-var">Ff</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679031002"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="f"><a href="Euterpea.Music.html#f"><span class="hs-identifier">f</span></a></a><span>    </span><a name="local-6989586621679031004"><a href="#local-6989586621679031004"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031005"><a href="#local-6989586621679031005"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031005"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#F"><span class="hs-identifier hs-var">F</span></a><span class="hs-special">,</span><span>    </span><a href="#local-6989586621679031004"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-190"></a><span class="hs-operator">&gt;</span><span> </span><a name="fs"><a href="Euterpea.Music.html#fs"><span class="hs-identifier">fs</span></a></a><span>   </span><a name="local-6989586621679031006"><a href="#local-6989586621679031006"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031007"><a href="#local-6989586621679031007"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031007"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Fs"><span class="hs-identifier hs-var">Fs</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679031006"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="fss"><a href="Euterpea.Music.html#fss"><span class="hs-identifier">fss</span></a></a><span>  </span><a name="local-6989586621679031008"><a href="#local-6989586621679031008"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031009"><a href="#local-6989586621679031009"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031009"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Fss"><span class="hs-identifier hs-var">Fss</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679031008"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-191"></a><span class="hs-operator">&gt;</span><span> </span><a name="gff"><a href="Euterpea.Music.html#gff"><span class="hs-identifier">gff</span></a></a><span>  </span><a name="local-6989586621679031010"><a href="#local-6989586621679031010"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031011"><a href="#local-6989586621679031011"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031011"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Gff"><span class="hs-identifier hs-var">Gff</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679031010"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="gf"><a href="Euterpea.Music.html#gf"><span class="hs-identifier">gf</span></a></a><span>   </span><a name="local-6989586621679031012"><a href="#local-6989586621679031012"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031013"><a href="#local-6989586621679031013"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031013"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Gf"><span class="hs-identifier hs-var">Gf</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679031012"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-192"></a><span class="hs-operator">&gt;</span><span> </span><a name="g"><a href="Euterpea.Music.html#g"><span class="hs-identifier">g</span></a></a><span>    </span><a name="local-6989586621679031014"><a href="#local-6989586621679031014"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031015"><a href="#local-6989586621679031015"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031015"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#G"><span class="hs-identifier hs-var">G</span></a><span class="hs-special">,</span><span>    </span><a href="#local-6989586621679031014"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="gs"><a href="Euterpea.Music.html#gs"><span class="hs-identifier">gs</span></a></a><span>   </span><a name="local-6989586621679031016"><a href="#local-6989586621679031016"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031017"><a href="#local-6989586621679031017"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031017"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Gs"><span class="hs-identifier hs-var">Gs</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679031016"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-193"></a><span class="hs-operator">&gt;</span><span> </span><a name="gss"><a href="Euterpea.Music.html#gss"><span class="hs-identifier">gss</span></a></a><span>  </span><a name="local-6989586621679031018"><a href="#local-6989586621679031018"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031019"><a href="#local-6989586621679031019"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031019"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Gss"><span class="hs-identifier hs-var">Gss</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679031018"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="aff"><a href="Euterpea.Music.html#aff"><span class="hs-identifier">aff</span></a></a><span>  </span><a name="local-6989586621679031020"><a href="#local-6989586621679031020"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031021"><a href="#local-6989586621679031021"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031021"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Aff"><span class="hs-identifier hs-var">Aff</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679031020"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-194"></a><span class="hs-operator">&gt;</span><span> </span><a name="af"><a href="Euterpea.Music.html#af"><span class="hs-identifier">af</span></a></a><span>   </span><a name="local-6989586621679031022"><a href="#local-6989586621679031022"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031023"><a href="#local-6989586621679031023"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031023"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Af"><span class="hs-identifier hs-var">Af</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679031022"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="a"><a href="Euterpea.Music.html#a"><span class="hs-identifier">a</span></a></a><span>    </span><a name="local-6989586621679031024"><a href="#local-6989586621679031024"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031025"><a href="#local-6989586621679031025"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031025"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#A"><span class="hs-identifier hs-var">A</span></a><span class="hs-special">,</span><span>    </span><a href="#local-6989586621679031024"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-195"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">as</span><span>   </span><a name="local-6989586621679031026"><a href="#local-6989586621679031026"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031027"><a href="#local-6989586621679031027"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031027"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#As"><span class="hs-identifier hs-var">As</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679031026"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="ass"><a href="Euterpea.Music.html#ass"><span class="hs-identifier">ass</span></a></a><span>  </span><a name="local-6989586621679031028"><a href="#local-6989586621679031028"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031029"><a href="#local-6989586621679031029"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031029"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Ass"><span class="hs-identifier hs-var">Ass</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679031028"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-196"></a><span class="hs-operator">&gt;</span><span> </span><a name="bff"><a href="Euterpea.Music.html#bff"><span class="hs-identifier">bff</span></a></a><span>  </span><a name="local-6989586621679031030"><a href="#local-6989586621679031030"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031031"><a href="#local-6989586621679031031"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031031"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Bff"><span class="hs-identifier hs-var">Bff</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679031030"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="bf"><a href="Euterpea.Music.html#bf"><span class="hs-identifier">bf</span></a></a><span>   </span><a name="local-6989586621679031032"><a href="#local-6989586621679031032"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031033"><a href="#local-6989586621679031033"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031033"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Bf"><span class="hs-identifier hs-var">Bf</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679031032"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-197"></a><span class="hs-operator">&gt;</span><span> </span><a name="b"><a href="Euterpea.Music.html#b"><span class="hs-identifier">b</span></a></a><span>    </span><a name="local-6989586621679031034"><a href="#local-6989586621679031034"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031035"><a href="#local-6989586621679031035"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031035"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#B"><span class="hs-identifier hs-var">B</span></a><span class="hs-special">,</span><span>    </span><a href="#local-6989586621679031034"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span class="hs-special">;</span><span>  </span><a name="bs"><a href="Euterpea.Music.html#bs"><span class="hs-identifier">bs</span></a></a><span>   </span><a name="local-6989586621679031036"><a href="#local-6989586621679031036"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031037"><a href="#local-6989586621679031037"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031037"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Bs"><span class="hs-identifier hs-var">Bs</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679031036"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-198"></a><span class="hs-operator">&gt;</span><span> </span><a name="bss"><a href="Euterpea.Music.html#bss"><span class="hs-identifier">bss</span></a></a><span>  </span><a name="local-6989586621679031038"><a href="#local-6989586621679031038"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679031039"><a href="#local-6989586621679031039"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679031039"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Bss"><span class="hs-identifier hs-var">Bss</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621679031038"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-199"></a><span></span><span>
</span><a name="line-200"></a><span></span><span>
</span><a name="line-201"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">bn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">qn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">en</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dwn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dhn</span><span class="hs-special">,</span><span> </span><span>
</span><a name="line-202"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-identifier">dqn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">den</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dsn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dtn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ddhn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ddqn</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dden</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span></span><span>
</span><a name="line-203"></a><span></span><span>
</span><a name="line-204"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">bnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">qnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">enr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">snr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dwnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dhnr</span><span class="hs-special">,</span><span> </span><span>
</span><a name="line-205"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-identifier">dqnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">denr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dsnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dtnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ddhnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ddqnr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ddenr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span></span><span>
</span><a name="line-206"></a><span></span><span>
</span><a name="line-207"></a><span class="hs-operator">&gt;</span><span> </span><a name="bn"><a href="Euterpea.Music.html#bn"><span class="hs-identifier">bn</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-special">;</span><span>     </span><a name="bnr"><a href="Euterpea.Music.html#bnr"><span class="hs-identifier">bnr</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#bn"><span class="hs-identifier hs-var">bn</span></a><span>    </span><span class="hs-comment">--  brevis rest</span><span>
</span><a name="line-208"></a><span class="hs-operator">&gt;</span><span> </span><a name="wn"><a href="Euterpea.Music.html#wn"><span class="hs-identifier">wn</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-special">;</span><span>     </span><a name="wnr"><a href="Euterpea.Music.html#wnr"><span class="hs-identifier">wnr</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#wn"><span class="hs-identifier hs-var">wn</span></a><span>    </span><span class="hs-comment">--  whole note rest</span><span>
</span><a name="line-209"></a><span class="hs-operator">&gt;</span><span> </span><a name="hn"><a href="Euterpea.Music.html#hn"><span class="hs-identifier">hn</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">;</span><span>   </span><a name="hnr"><a href="Euterpea.Music.html#hnr"><span class="hs-identifier">hnr</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#hn"><span class="hs-identifier hs-var">hn</span></a><span>    </span><span class="hs-comment">--  half note rest</span><span>
</span><a name="line-210"></a><span class="hs-operator">&gt;</span><span> </span><a name="qn"><a href="Euterpea.Music.html#qn"><span class="hs-identifier">qn</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">;</span><span>   </span><a name="qnr"><a href="Euterpea.Music.html#qnr"><span class="hs-identifier">qnr</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#qn"><span class="hs-identifier hs-var">qn</span></a><span>    </span><span class="hs-comment">--  quarter note rest</span><span>
</span><a name="line-211"></a><span class="hs-operator">&gt;</span><span> </span><a name="en"><a href="Euterpea.Music.html#en"><span class="hs-identifier">en</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-number">8</span><span class="hs-special">;</span><span>   </span><a name="enr"><a href="Euterpea.Music.html#enr"><span class="hs-identifier">enr</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#en"><span class="hs-identifier hs-var">en</span></a><span>    </span><span class="hs-comment">--  eighth note rest</span><span>
</span><a name="line-212"></a><span class="hs-operator">&gt;</span><span> </span><a name="sn"><a href="Euterpea.Music.html#sn"><span class="hs-identifier">sn</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-number">16</span><span class="hs-special">;</span><span>  </span><a name="snr"><a href="Euterpea.Music.html#snr"><span class="hs-identifier">snr</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#sn"><span class="hs-identifier hs-var">sn</span></a><span>    </span><span class="hs-comment">--  sixteenth note rest</span><span>
</span><a name="line-213"></a><span class="hs-operator">&gt;</span><span> </span><a name="tn"><a href="Euterpea.Music.html#tn"><span class="hs-identifier">tn</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-number">32</span><span class="hs-special">;</span><span>  </span><a name="tnr"><a href="Euterpea.Music.html#tnr"><span class="hs-identifier">tnr</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#tn"><span class="hs-identifier hs-var">tn</span></a><span>    </span><span class="hs-comment">--  thirty-second note rest</span><span>
</span><a name="line-214"></a><span class="hs-operator">&gt;</span><span> </span><a name="sfn"><a href="Euterpea.Music.html#sfn"><span class="hs-identifier">sfn</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-number">64</span><span class="hs-special">;</span><span>  </span><a name="sfnr"><a href="Euterpea.Music.html#sfnr"><span class="hs-identifier">sfnr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#sfn"><span class="hs-identifier hs-var">sfn</span></a><span>   </span><span class="hs-comment">--  sixty-fourth note rest</span><span>
</span><a name="line-215"></a><span></span><span>
</span><a name="line-216"></a><span class="hs-operator">&gt;</span><span> </span><a name="dwn"><a href="Euterpea.Music.html#dwn"><span class="hs-identifier">dwn</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">;</span><span>   </span><a name="dwnr"><a href="Euterpea.Music.html#dwnr"><span class="hs-identifier">dwnr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#dwn"><span class="hs-identifier hs-var">dwn</span></a><span>   </span><span class="hs-comment">--  dotted whole note rest</span><span>
</span><a name="line-217"></a><span class="hs-operator">&gt;</span><span> </span><a name="dhn"><a href="Euterpea.Music.html#dhn"><span class="hs-identifier">dhn</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">;</span><span>   </span><a name="dhnr"><a href="Euterpea.Music.html#dhnr"><span class="hs-identifier">dhnr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#dhn"><span class="hs-identifier hs-var">dhn</span></a><span>   </span><span class="hs-comment">--  dotted half note rest</span><span>
</span><a name="line-218"></a><span class="hs-operator">&gt;</span><span> </span><a name="dqn"><a href="Euterpea.Music.html#dqn"><span class="hs-identifier">dqn</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span class="hs-operator hs-var">/</span><span class="hs-number">8</span><span class="hs-special">;</span><span>   </span><a name="dqnr"><a href="Euterpea.Music.html#dqnr"><span class="hs-identifier">dqnr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#dqn"><span class="hs-identifier hs-var">dqn</span></a><span>   </span><span class="hs-comment">--  dotted quarter note rest</span><span>
</span><a name="line-219"></a><span class="hs-operator">&gt;</span><span> </span><a name="den"><a href="Euterpea.Music.html#den"><span class="hs-identifier">den</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span class="hs-operator hs-var">/</span><span class="hs-number">16</span><span class="hs-special">;</span><span>  </span><a name="denr"><a href="Euterpea.Music.html#denr"><span class="hs-identifier">denr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#den"><span class="hs-identifier hs-var">den</span></a><span>   </span><span class="hs-comment">--  dotted eighth note rest</span><span>
</span><a name="line-220"></a><span class="hs-operator">&gt;</span><span> </span><a name="dsn"><a href="Euterpea.Music.html#dsn"><span class="hs-identifier">dsn</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span class="hs-operator hs-var">/</span><span class="hs-number">32</span><span class="hs-special">;</span><span>  </span><a name="dsnr"><a href="Euterpea.Music.html#dsnr"><span class="hs-identifier">dsnr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#dsn"><span class="hs-identifier hs-var">dsn</span></a><span>   </span><span class="hs-comment">--  dotted sixteenth note rest</span><span>
</span><a name="line-221"></a><span class="hs-operator">&gt;</span><span> </span><a name="dtn"><a href="Euterpea.Music.html#dtn"><span class="hs-identifier">dtn</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span class="hs-operator hs-var">/</span><span class="hs-number">64</span><span class="hs-special">;</span><span>  </span><a name="dtnr"><a href="Euterpea.Music.html#dtnr"><span class="hs-identifier">dtnr</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#dtn"><span class="hs-identifier hs-var">dtn</span></a><span>   </span><span class="hs-comment">--  dotted thirty-second note rest</span><span>
</span><a name="line-222"></a><span></span><span>
</span><a name="line-223"></a><span class="hs-operator">&gt;</span><span> </span><a name="ddhn"><a href="Euterpea.Music.html#ddhn"><span class="hs-identifier">ddhn</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">7</span><span class="hs-operator hs-var">/</span><span class="hs-number">8</span><span class="hs-special">;</span><span>   </span><a name="ddhnr"><a href="Euterpea.Music.html#ddhnr"><span class="hs-identifier">ddhnr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#ddhn"><span class="hs-identifier hs-var">ddhn</span></a><span>  </span><span class="hs-comment">--  double-dotted half note rest</span><span>
</span><a name="line-224"></a><span class="hs-operator">&gt;</span><span> </span><a name="ddqn"><a href="Euterpea.Music.html#ddqn"><span class="hs-identifier">ddqn</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">7</span><span class="hs-operator hs-var">/</span><span class="hs-number">16</span><span class="hs-special">;</span><span>  </span><a name="ddqnr"><a href="Euterpea.Music.html#ddqnr"><span class="hs-identifier">ddqnr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#ddqn"><span class="hs-identifier hs-var">ddqn</span></a><span>  </span><span class="hs-comment">--  double-dotted quarter note rest</span><span>
</span><a name="line-225"></a><span class="hs-operator">&gt;</span><span> </span><a name="dden"><a href="Euterpea.Music.html#dden"><span class="hs-identifier">dden</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">7</span><span class="hs-operator hs-var">/</span><span class="hs-number">32</span><span class="hs-special">;</span><span>  </span><a name="ddenr"><a href="Euterpea.Music.html#ddenr"><span class="hs-identifier">ddenr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="Euterpea.Music.html#dden"><span class="hs-identifier hs-var">dden</span></a><span>  </span><span class="hs-comment">--  double-dotted eighth note rest</span><span>
</span><a name="line-226"></a><span></span><span>
</span><a name="line-227"></a><span class="hs-identifier">The</span><span> </span><span class="hs-identifier">conversion</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">Pitch</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">AbsPitch</span><span> </span><span class="hs-identifier">differs</span><span> </span><span class="hs-identifier">from</span><span> </span><span class="hs-identifier">previous</span><span> </span><span class="hs-identifier">versions</span><span></span><span>
</span><a name="line-228"></a><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">Euterpea</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">In</span><span> </span><span class="hs-identifier">Euterpea</span><span> </span><span class="hs-number">1</span><span class="hs-operator">.</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C</span><span class="hs-special">,</span><span class="hs-number">5</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">was</span><span> </span><span class="hs-identifier">pitch</span><span> </span><span class="hs-identifier">number</span><span> </span><span class="hs-number">60</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">not</span><span></span><span>
</span><a name="line-229"></a><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">most</span><span> </span><span class="hs-identifier">common</span><span> </span><span class="hs-identifier">interpretation</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">While</span><span> </span><span class="hs-identifier">there</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">no</span><span> </span><span class="hs-identifier">universal</span><span> </span><span class="hs-identifier">standard</span><span> </span><span>
</span><a name="line-230"></a><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">octave</span><span> </span><span class="hs-identifier">should</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">octave</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">far</span><span> </span><span class="hs-identifier">more</span><span> </span><span class="hs-identifier">common</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">have</span><span> </span><span class="hs-identifier">the</span><span></span><span>
</span><a name="line-231"></a><span class="hs-identifier">pitch</span><span> </span><span class="hs-identifier">number</span><span> </span><span class="hs-identifier">relationship</span><span> </span><span class="hs-identifier">that</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C</span><span class="hs-special">,</span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">60</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Since</span><span> </span><span class="hs-identifier">this</span><span> </span><span class="hs-identifier">change</span><span> </span><span class="hs-identifier">has</span><span> </span><span class="hs-identifier">been</span><span> </span><span>
</span><a name="line-232"></a><span class="hs-identifier">requested</span><span> </span><span class="hs-identifier">many</span><span> </span><span class="hs-identifier">times</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">previous</span><span> </span><span class="hs-identifier">versions</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">Euterpea</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">following</span><span> </span><span>
</span><a name="line-233"></a><span class="hs-identifier">standard</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">now</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">place</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">version</span><span> </span><span class="hs-number">2.0</span><span class="hs-operator">.</span><span class="hs-number">0</span><span class="hs-glyph">:</span><span></span><span>
</span><a name="line-234"></a><span></span><span>
</span><a name="line-235"></a><span class="hs-identifier">pitch</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-236"></a><span class="hs-identifier">pitch</span><span> </span><span class="hs-number">60</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C</span><span class="hs-special">,</span><span class="hs-number">4</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-237"></a><span class="hs-identifier">pitch</span><span> </span><span class="hs-number">127</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">G</span><span class="hs-special">,</span><span class="hs-number">9</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-238"></a><span></span><span>
</span><a name="line-239"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">absPitch</span><span>           </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#AbsPitch"><span class="hs-identifier hs-type">AbsPitch</span></a><span></span><span>
</span><a name="line-240"></a><span class="hs-operator">&gt;</span><span> </span><a name="absPitch"><a href="Euterpea.Music.html#absPitch"><span class="hs-identifier">absPitch</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679031040"><a href="#local-6989586621679031040"><span class="hs-identifier">pc</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031041"><a href="#local-6989586621679031041"><span class="hs-identifier">oct</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">12</span><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><a href="#local-6989586621679031041"><span class="hs-identifier hs-var">oct</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Euterpea.Music.html#pcToInt"><span class="hs-identifier hs-var">pcToInt</span></a><span> </span><a href="#local-6989586621679031040"><span class="hs-identifier hs-var">pc</span></a><span></span><span>
</span><a name="line-241"></a><span></span><span>
</span><a name="line-242"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">pcToInt</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#PitchClass"><span class="hs-identifier hs-type">PitchClass</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span></span><span>
</span><a name="line-243"></a><span class="hs-operator">&gt;</span><span> </span><a name="pcToInt"><a href="Euterpea.Music.html#pcToInt"><span class="hs-identifier">pcToInt</span></a></a><span> </span><a name="local-6989586621679031106"><a href="#local-6989586621679031106"><span class="hs-identifier">pc</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679031106"><span class="hs-identifier hs-var">pc</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-244"></a><span class="hs-operator">&gt;</span><span>   </span><a href="Euterpea.Music.html#Cff"><span class="hs-identifier hs-var">Cff</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">2</span><span class="hs-special">;</span><span>  </span><a href="Euterpea.Music.html#Cf"><span class="hs-identifier hs-var">Cf</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">;</span><span>  </span><a href="Euterpea.Music.html#C"><span class="hs-identifier hs-var">C</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Cs"><span class="hs-identifier hs-var">Cs</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Css"><span class="hs-identifier hs-var">Css</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">2</span><span class="hs-special">;</span><span> </span><span>
</span><a name="line-245"></a><span class="hs-operator">&gt;</span><span>   </span><a href="Euterpea.Music.html#Dff"><span class="hs-identifier hs-var">Dff</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Df"><span class="hs-identifier hs-var">Df</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#D"><span class="hs-identifier hs-var">D</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">2</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Ds"><span class="hs-identifier hs-var">Ds</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">3</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Dss"><span class="hs-identifier hs-var">Dss</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">4</span><span class="hs-special">;</span><span> </span><span>
</span><a name="line-246"></a><span class="hs-operator">&gt;</span><span>   </span><a href="Euterpea.Music.html#Eff"><span class="hs-identifier hs-var">Eff</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">2</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Ef"><span class="hs-identifier hs-var">Ef</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">3</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#E"><span class="hs-identifier hs-var">E</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">4</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Es"><span class="hs-identifier hs-var">Es</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">5</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Ess"><span class="hs-identifier hs-var">Ess</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">6</span><span class="hs-special">;</span><span> </span><span>
</span><a name="line-247"></a><span class="hs-operator">&gt;</span><span>   </span><a href="Euterpea.Music.html#Fff"><span class="hs-identifier hs-var">Fff</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">3</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Ff"><span class="hs-identifier hs-var">Ff</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">4</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#F"><span class="hs-identifier hs-var">F</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">5</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Fs"><span class="hs-identifier hs-var">Fs</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">6</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Fss"><span class="hs-identifier hs-var">Fss</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">7</span><span class="hs-special">;</span><span> </span><span>
</span><a name="line-248"></a><span class="hs-operator">&gt;</span><span>   </span><a href="Euterpea.Music.html#Gff"><span class="hs-identifier hs-var">Gff</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">5</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Gf"><span class="hs-identifier hs-var">Gf</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">6</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#G"><span class="hs-identifier hs-var">G</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">7</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Gs"><span class="hs-identifier hs-var">Gs</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">8</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Gss"><span class="hs-identifier hs-var">Gss</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">9</span><span class="hs-special">;</span><span> </span><span>
</span><a name="line-249"></a><span class="hs-operator">&gt;</span><span>   </span><a href="Euterpea.Music.html#Aff"><span class="hs-identifier hs-var">Aff</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">7</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Af"><span class="hs-identifier hs-var">Af</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">8</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#A"><span class="hs-identifier hs-var">A</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">9</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#As"><span class="hs-identifier hs-var">As</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">;</span><span>  </span><a href="Euterpea.Music.html#Ass"><span class="hs-identifier hs-var">Ass</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">11</span><span class="hs-special">;</span><span></span><span>
</span><a name="line-250"></a><span class="hs-operator">&gt;</span><span>   </span><a href="Euterpea.Music.html#Bff"><span class="hs-identifier hs-var">Bff</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">9</span><span class="hs-special">;</span><span>   </span><a href="Euterpea.Music.html#Bf"><span class="hs-identifier hs-var">Bf</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">;</span><span>  </span><a href="Euterpea.Music.html#B"><span class="hs-identifier hs-var">B</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">11</span><span class="hs-special">;</span><span>  </span><a href="Euterpea.Music.html#Bs"><span class="hs-identifier hs-var">Bs</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">12</span><span class="hs-special">;</span><span>  </span><a href="Euterpea.Music.html#Bss"><span class="hs-identifier hs-var">Bss</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">13</span><span></span><span>
</span><a name="line-251"></a><span></span><span>
</span><a name="line-252"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">pitch</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#AbsPitch"><span class="hs-identifier hs-type">AbsPitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span></span><span>
</span><a name="line-253"></a><span class="hs-operator">&gt;</span><span> </span><a name="pitch"><a href="Euterpea.Music.html#pitch"><span class="hs-identifier">pitch</span></a></a><span> </span><a name="local-6989586621679031107"><a href="#local-6989586621679031107"><span class="hs-identifier">ap</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-254"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031108"><a href="#local-6989586621679031108"><span class="hs-identifier">oct</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679031109"><a href="#local-6989586621679031109"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">divMod</span><span> </span><a href="#local-6989586621679031107"><span class="hs-identifier hs-var">ap</span></a><span> </span><span class="hs-number">12</span><span></span><span>
</span><a name="line-255"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Euterpea.Music.html#C"><span class="hs-identifier hs-var">C</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#Cs"><span class="hs-identifier hs-var">Cs</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#D"><span class="hs-identifier hs-var">D</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#Ds"><span class="hs-identifier hs-var">Ds</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#E"><span class="hs-identifier hs-var">E</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#F"><span class="hs-identifier hs-var">F</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#Fs"><span class="hs-identifier hs-var">Fs</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#G"><span class="hs-identifier hs-var">G</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#Gs"><span class="hs-identifier hs-var">Gs</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#A"><span class="hs-identifier hs-var">A</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#As"><span class="hs-identifier hs-var">As</span></a><span class="hs-special">,</span><a href="Euterpea.Music.html#B"><span class="hs-identifier hs-var">B</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679031109"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031108"><span class="hs-identifier hs-var">oct</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-256"></a><span></span><span>
</span><a name="line-257"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">trans</span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span></span><span>
</span><a name="line-258"></a><span class="hs-operator">&gt;</span><span> </span><a name="trans"><a href="Euterpea.Music.html#trans"><span class="hs-identifier">trans</span></a></a><span> </span><a name="local-6989586621679031305"><a href="#local-6989586621679031305"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679031306"><a href="#local-6989586621679031306"><span class="hs-identifier">p</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#pitch"><span class="hs-identifier hs-var">pitch</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#absPitch"><span class="hs-identifier hs-var">absPitch</span></a><span> </span><a href="#local-6989586621679031306"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679031305"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-259"></a><span></span><span>
</span><a name="line-260"></a><span></span><span>
</span><a name="line-261"></a><span></span><span>
</span><a name="line-262"></a><span></span><span>
</span><a name="line-263"></a><span></span><span>
</span><a name="line-264"></a><span></span><span>
</span><a name="line-265"></a><span class="hs-comment">-- =================================================================================</span><span>
</span><a name="line-266"></a><span class="hs-comment">-- From MoreMusic.hs</span><span>
</span><a name="line-267"></a><span></span><span>
</span><a name="line-268"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">line</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">chord</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030946"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030946"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-269"></a><span class="hs-operator">&gt;</span><span> </span><a name="line"><a href="Euterpea.Music.html#line"><span class="hs-identifier">line</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-270"></a><span class="hs-operator">&gt;</span><span> </span><a name="chord"><a href="Euterpea.Music.html#chord"><span class="hs-identifier">chord</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-271"></a><span></span><span>
</span><a name="line-272"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">line1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">chord1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030945"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030945"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-273"></a><span class="hs-operator">&gt;</span><span> </span><a name="line1"><a href="Euterpea.Music.html#line1"><span class="hs-identifier">line1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr1</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-274"></a><span class="hs-operator">&gt;</span><span> </span><a name="chord1"><a href="Euterpea.Music.html#chord1"><span class="hs-identifier">chord1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr1</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-275"></a><span></span><span>
</span><a name="line-276"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">offset</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030944"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030944"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-277"></a><span class="hs-operator">&gt;</span><span> </span><a name="offset"><a href="Euterpea.Music.html#offset"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679032383"><a href="#local-6989586621679032383"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679032384"><a href="#local-6989586621679032384"><span class="hs-identifier">m</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="#local-6989586621679032383"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="#local-6989586621679032384"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-278"></a><span></span><span>
</span><a name="line-279"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">times</span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030943"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030943"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-280"></a><span class="hs-operator">&gt;</span><span> </span><a name="times"><a href="Euterpea.Music.html#times"><span class="hs-identifier">times</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679032385"><a href="#local-6989586621679032385"><span class="hs-identifier">m</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-number">0</span><span></span><span>
</span><a name="line-281"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">times</span><span> </span><a name="local-6989586621679032386"><a href="#local-6989586621679032386"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679032387"><a href="#local-6989586621679032387"><span class="hs-identifier">m</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032387"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="Euterpea.Music.html#times"><span class="hs-identifier hs-var">times</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032386"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032387"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-282"></a><span></span><span>
</span><a name="line-283"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">forever</span><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030942"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030942"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-284"></a><span class="hs-operator">&gt;</span><span> </span><a name="forever"><a href="Euterpea.Music.html#forever"><span class="hs-identifier">forever</span></a></a><span> </span><a name="local-6989586621679032388"><a href="#local-6989586621679032388"><span class="hs-identifier">m</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032388"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="Euterpea.Music.html#forever"><span class="hs-identifier hs-var">forever</span></a><span> </span><a href="#local-6989586621679032388"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-285"></a><span></span><span>
</span><a name="line-286"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">lineToList</span><span>                    </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030941"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030941"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-287"></a><span class="hs-operator">&gt;</span><span> </span><a name="lineToList"><a href="Euterpea.Music.html#lineToList"><span class="hs-identifier">lineToList</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-288"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">lineToList</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032389"><a href="#local-6989586621679032389"><span class="hs-identifier">n</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032390"><a href="#local-6989586621679032390"><span class="hs-identifier">ns</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032389"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Euterpea.Music.html#lineToList"><span class="hs-identifier hs-var">lineToList</span></a><span> </span><a href="#local-6989586621679032390"><span class="hs-identifier hs-var">ns</span></a><span></span><span>
</span><a name="line-289"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">lineToList</span><span> </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-290"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;lineToList: argument not created by function line&quot;</span><span></span><span>
</span><a name="line-291"></a><span></span><span>
</span><a name="line-292"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">invertAt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span></span><span>
</span><a name="line-293"></a><span class="hs-operator">&gt;</span><span> </span><a name="invertAt"><a href="Euterpea.Music.html#invertAt"><span class="hs-identifier">invertAt</span></a></a><span> </span><a name="local-6989586621679032424"><a href="#local-6989586621679032424"><span class="hs-identifier">pRef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679032425"><a href="#local-6989586621679032425"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#pitch"><span class="hs-identifier hs-var">pitch</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="Euterpea.Music.html#absPitch"><span class="hs-identifier hs-var">absPitch</span></a><span> </span><a href="#local-6989586621679032424"><span class="hs-identifier hs-var">pRef</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Euterpea.Music.html#absPitch"><span class="hs-identifier hs-var">absPitch</span></a><span> </span><a href="#local-6989586621679032425"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-294"></a><span></span><span>
</span><a name="line-295"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">invertAt1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679030940"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679030940"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-296"></a><span class="hs-operator">&gt;</span><span> </span><a name="invertAt1"><a href="Euterpea.Music.html#invertAt1"><span class="hs-identifier">invertAt1</span></a></a><span> </span><a name="local-6989586621679032426"><a href="#local-6989586621679032426"><span class="hs-identifier">pRef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679032427"><a href="#local-6989586621679032427"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032428"><a href="#local-6989586621679032428"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#pitch"><span class="hs-identifier hs-var">pitch</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="Euterpea.Music.html#absPitch"><span class="hs-identifier hs-var">absPitch</span></a><span> </span><a href="#local-6989586621679032426"><span class="hs-identifier hs-var">pRef</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Euterpea.Music.html#absPitch"><span class="hs-identifier hs-var">absPitch</span></a><span> </span><a href="#local-6989586621679032427"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679032428"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-297"></a><span></span><span>
</span><a name="line-298"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">invert</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span></span><span>
</span><a name="line-299"></a><span class="hs-operator">&gt;</span><span> </span><a name="invert"><a href="Euterpea.Music.html#invert"><span class="hs-identifier">invert</span></a></a><span> </span><a name="local-6989586621679032429"><a href="#local-6989586621679032429"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-300"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032433"><a href="#local-6989586621679032433"><span class="hs-identifier">pRef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mFold"><span class="hs-identifier hs-var">mFold</span></a><span> </span><a href="#local-6989586621679032430"><span class="hs-identifier hs-var">pFun</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">const</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032429"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-301"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679032433"><span class="hs-identifier hs-var">pRef</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679032429"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-comment">-- no pitches in the structure!</span><span>
</span><a name="line-302"></a><span class="hs-operator">&gt;</span><span>         </span><span class="hs-keyword">else</span><span> </span><a href="Euterpea.Music.html#invertAt"><span class="hs-identifier hs-var">invertAt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679032433"><span class="hs-identifier hs-var">pRef</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032429"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-303"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679032430"><a href="#local-6989586621679032430"><span class="hs-identifier">pFun</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><a name="local-6989586621679032431"><a href="#local-6989586621679032431"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679032432"><a href="#local-6989586621679032432"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032432"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-304"></a><span class="hs-operator">&gt;</span><span>           </span><span class="hs-identifier">pFun</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-305"></a><span></span><span>
</span><a name="line-306"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">invert1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span class="hs-special">,</span><a href="#local-6989586621679030939"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span class="hs-special">,</span><a href="#local-6989586621679030939"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-307"></a><span class="hs-operator">&gt;</span><span> </span><a name="invert1"><a href="Euterpea.Music.html#invert1"><span class="hs-identifier">invert1</span></a></a><span> </span><a name="local-6989586621679032434"><a href="#local-6989586621679032434"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-308"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032439"><a href="#local-6989586621679032439"><span class="hs-identifier">pRef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mFold"><span class="hs-identifier hs-var">mFold</span></a><span> </span><a href="#local-6989586621679032435"><span class="hs-identifier hs-var">pFun</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">const</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032434"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-309"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679032439"><span class="hs-identifier hs-var">pRef</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679032434"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-comment">-- no pitches!</span><span>
</span><a name="line-310"></a><span class="hs-operator">&gt;</span><span>         </span><span class="hs-keyword">else</span><span> </span><a href="Euterpea.Music.html#invertAt1"><span class="hs-identifier hs-var">invertAt1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679032439"><span class="hs-identifier hs-var">pRef</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032434"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-311"></a><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679032435"><a href="#local-6989586621679032435"><span class="hs-identifier">pFun</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><a name="local-6989586621679032436"><a href="#local-6989586621679032436"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032437"><a href="#local-6989586621679032437"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032438"><a href="#local-6989586621679032438"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032437"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-312"></a><span class="hs-operator">&gt;</span><span>           </span><span class="hs-identifier">pFun</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-313"></a><span></span><span>
</span><a name="line-314"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">retro</span><span>               </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030938"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030938"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-315"></a><span class="hs-operator">&gt;</span><span> </span><a name="retro"><a href="Euterpea.Music.html#retro"><span class="hs-identifier">retro</span></a></a><span> </span><a name="local-6989586621679032440"><a href="#local-6989586621679032440"><span class="hs-identifier">n</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032440"><span class="hs-identifier hs-var">n</span></a><span></span><span>
</span><a name="line-316"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">retro</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a name="local-6989586621679032441"><a href="#local-6989586621679032441"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679032442"><a href="#local-6989586621679032442"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a href="#local-6989586621679032441"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#retro"><span class="hs-identifier hs-var">retro</span></a><span> </span><a href="#local-6989586621679032442"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-317"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">retro</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032443"><a href="#local-6989586621679032443"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032444"><a href="#local-6989586621679032444"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#retro"><span class="hs-identifier hs-var">retro</span></a><span> </span><a href="#local-6989586621679032444"><span class="hs-identifier hs-var">m2</span></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="Euterpea.Music.html#retro"><span class="hs-identifier hs-var">retro</span></a><span> </span><a href="#local-6989586621679032443"><span class="hs-identifier hs-var">m1</span></a><span></span><span>
</span><a name="line-318"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">retro</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032445"><a href="#local-6989586621679032445"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a name="local-6989586621679032446"><a href="#local-6989586621679032446"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span>  </span><span>
</span><a name="line-319"></a><span class="hs-operator">&gt;</span><span>    </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679032447"><a href="#local-6989586621679032447"><span class="hs-identifier">d1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032445"><span class="hs-identifier hs-var">m1</span></a><span></span><span>
</span><a name="line-320"></a><span class="hs-operator">&gt;</span><span>         </span><a name="local-6989586621679032448"><a href="#local-6989586621679032448"><span class="hs-identifier">d2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032446"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-321"></a><span class="hs-operator">&gt;</span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679032447"><span class="hs-identifier hs-var">d1</span></a><span class="hs-operator hs-var">&gt;</span><a href="#local-6989586621679032448"><span class="hs-identifier hs-var">d2</span></a><span>  </span><span class="hs-keyword">then</span><span> </span><a href="Euterpea.Music.html#retro"><span class="hs-identifier hs-var">retro</span></a><span> </span><a href="#local-6989586621679032445"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032447"><span class="hs-identifier hs-var">d1</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679032448"><span class="hs-identifier hs-var">d2</span></a><span class="hs-special">)</span><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="Euterpea.Music.html#retro"><span class="hs-identifier hs-var">retro</span></a><span> </span><a href="#local-6989586621679032446"><span class="hs-identifier hs-var">m2</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-322"></a><span class="hs-operator">&gt;</span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032448"><span class="hs-identifier hs-var">d2</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679032447"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">)</span><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="Euterpea.Music.html#retro"><span class="hs-identifier hs-var">retro</span></a><span> </span><a href="#local-6989586621679032445"><span class="hs-identifier hs-var">m1</span></a><span class="hs-special">)</span><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a href="Euterpea.Music.html#retro"><span class="hs-identifier hs-var">retro</span></a><span> </span><a href="#local-6989586621679032446"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-323"></a><span></span><span>
</span><a name="line-324"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">retroInvert</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">invertRetro</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span></span><span>
</span><a name="line-325"></a><span class="hs-operator">&gt;</span><span> </span><a name="retroInvert"><a href="Euterpea.Music.html#retroInvert"><span class="hs-identifier">retroInvert</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#retro"><span class="hs-identifier hs-var">retro</span></a><span>  </span><span class="hs-operator hs-var">.</span><span> </span><a href="Euterpea.Music.html#invert"><span class="hs-identifier hs-var">invert</span></a><span></span><span>
</span><a name="line-326"></a><span class="hs-operator">&gt;</span><span> </span><a name="invertRetro"><a href="Euterpea.Music.html#invertRetro"><span class="hs-identifier">invertRetro</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#invert"><span class="hs-identifier hs-var">invert</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Euterpea.Music.html#retro"><span class="hs-identifier hs-var">retro</span></a><span></span><span>
</span><a name="line-327"></a><span></span><span>
</span><a name="line-328"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">dur</span><span>                       </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030937"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span></span><span>
</span><a name="line-329"></a><span class="hs-operator">&gt;</span><span> </span><a name="dur"><a href="Euterpea.Music.html#dur"><span class="hs-identifier">dur</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><a name="local-6989586621679032449"><a href="#local-6989586621679032449"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032449"><span class="hs-identifier hs-var">d</span></a><span></span><span>
</span><a name="line-330"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">dur</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><a name="local-6989586621679032450"><a href="#local-6989586621679032450"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032450"><span class="hs-identifier hs-var">d</span></a><span></span><span>
</span><a name="line-331"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">dur</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032451"><a href="#local-6989586621679032451"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032452"><a href="#local-6989586621679032452"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032451"><span class="hs-identifier hs-var">m1</span></a><span>   </span><span class="hs-operator hs-var">+</span><span>   </span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032452"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-332"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">dur</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032453"><a href="#local-6989586621679032453"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a name="local-6989586621679032454"><a href="#local-6989586621679032454"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032453"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">max</span><span class="hs-special">`</span><span> </span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032454"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-333"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">dur</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Tempo"><span class="hs-identifier hs-var">Tempo</span></a><span> </span><a name="local-6989586621679032455"><a href="#local-6989586621679032455"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032456"><a href="#local-6989586621679032456"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032456"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679032455"><span class="hs-identifier hs-var">r</span></a><span></span><span>
</span><a name="line-334"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">dur</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679032457"><a href="#local-6989586621679032457"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032457"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-335"></a><span></span><span>
</span><a name="line-336"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cut</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030936"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030936"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-337"></a><span class="hs-operator">&gt;</span><span> </span><a name="cut"><a href="Euterpea.Music.html#cut"><span class="hs-identifier">cut</span></a></a><span> </span><a name="local-6989586621679032458"><a href="#local-6989586621679032458"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679032459"><a href="#local-6989586621679032459"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032458"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-number">0</span><span></span><span>
</span><a name="line-338"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cut</span><span> </span><a name="local-6989586621679032460"><a href="#local-6989586621679032460"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><a name="local-6989586621679032461"><a href="#local-6989586621679032461"><span class="hs-identifier">oldD</span></a></a><span> </span><a name="local-6989586621679032462"><a href="#local-6989586621679032462"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">min</span><span> </span><a href="#local-6989586621679032461"><span class="hs-identifier hs-var">oldD</span></a><span> </span><a href="#local-6989586621679032460"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032462"><span class="hs-identifier hs-var">p</span></a><span></span><span>
</span><a name="line-339"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cut</span><span> </span><a name="local-6989586621679032463"><a href="#local-6989586621679032463"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><a name="local-6989586621679032464"><a href="#local-6989586621679032464"><span class="hs-identifier">oldD</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">min</span><span> </span><a href="#local-6989586621679032464"><span class="hs-identifier hs-var">oldD</span></a><span> </span><a href="#local-6989586621679032463"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-340"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cut</span><span> </span><a name="local-6989586621679032465"><a href="#local-6989586621679032465"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032466"><a href="#local-6989586621679032466"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a name="local-6989586621679032467"><a href="#local-6989586621679032467"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#cut"><span class="hs-identifier hs-var">cut</span></a><span> </span><a href="#local-6989586621679032465"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679032466"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a href="Euterpea.Music.html#cut"><span class="hs-identifier hs-var">cut</span></a><span> </span><a href="#local-6989586621679032465"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679032467"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-341"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cut</span><span> </span><a name="local-6989586621679032468"><a href="#local-6989586621679032468"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032469"><a href="#local-6989586621679032469"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032470"><a href="#local-6989586621679032470"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679032471"><a href="#local-6989586621679032471"><span class="hs-identifier">m'1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#cut"><span class="hs-identifier hs-var">cut</span></a><span> </span><a href="#local-6989586621679032468"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679032469"><span class="hs-identifier hs-var">m1</span></a><span></span><span>
</span><a name="line-342"></a><span class="hs-operator">&gt;</span><span>                                     </span><a name="local-6989586621679032472"><a href="#local-6989586621679032472"><span class="hs-identifier">m'2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#cut"><span class="hs-identifier hs-var">cut</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032468"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032471"><span class="hs-identifier hs-var">m'1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032470"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-343"></a><span class="hs-operator">&gt;</span><span>                                </span><span class="hs-keyword">in</span><span>   </span><a href="#local-6989586621679032471"><span class="hs-identifier hs-var">m'1</span></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="#local-6989586621679032472"><span class="hs-identifier hs-var">m'2</span></a><span></span><span>
</span><a name="line-344"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cut</span><span> </span><a name="local-6989586621679032473"><a href="#local-6989586621679032473"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Tempo"><span class="hs-identifier hs-var">Tempo</span></a><span> </span><a name="local-6989586621679032474"><a href="#local-6989586621679032474"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032475"><a href="#local-6989586621679032475"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#tempo"><span class="hs-identifier hs-var">tempo</span></a><span> </span><a href="#local-6989586621679032474"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#cut"><span class="hs-identifier hs-var">cut</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032473"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679032474"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032475"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-345"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cut</span><span> </span><a name="local-6989586621679032476"><a href="#local-6989586621679032476"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a name="local-6989586621679032477"><a href="#local-6989586621679032477"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679032478"><a href="#local-6989586621679032478"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a href="#local-6989586621679032477"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#cut"><span class="hs-identifier hs-var">cut</span></a><span> </span><a href="#local-6989586621679032476"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679032478"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-346"></a><span></span><span>
</span><a name="line-347"></a><span></span><span>
</span><a name="line-348"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">remove</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030935"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030935"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-349"></a><span class="hs-operator">&gt;</span><span> </span><a name="remove"><a href="Euterpea.Music.html#remove"><span class="hs-identifier">remove</span></a></a><span> </span><a name="local-6989586621679032479"><a href="#local-6989586621679032479"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679032480"><a href="#local-6989586621679032480"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032479"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032480"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-350"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">remove</span><span> </span><a name="local-6989586621679032481"><a href="#local-6989586621679032481"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><a name="local-6989586621679032482"><a href="#local-6989586621679032482"><span class="hs-identifier">oldD</span></a></a><span> </span><a name="local-6989586621679032483"><a href="#local-6989586621679032483"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">max</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032482"><span class="hs-identifier hs-var">oldD</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679032481"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032483"><span class="hs-identifier hs-var">p</span></a><span></span><span>
</span><a name="line-351"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">remove</span><span> </span><a name="local-6989586621679032484"><a href="#local-6989586621679032484"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><a name="local-6989586621679032485"><a href="#local-6989586621679032485"><span class="hs-identifier">oldD</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">max</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032485"><span class="hs-identifier hs-var">oldD</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679032484"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-352"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">remove</span><span> </span><a name="local-6989586621679032486"><a href="#local-6989586621679032486"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032487"><a href="#local-6989586621679032487"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a name="local-6989586621679032488"><a href="#local-6989586621679032488"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#remove"><span class="hs-identifier hs-var">remove</span></a><span> </span><a href="#local-6989586621679032486"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679032487"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a href="Euterpea.Music.html#remove"><span class="hs-identifier hs-var">remove</span></a><span> </span><a href="#local-6989586621679032486"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679032488"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-353"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">remove</span><span> </span><a name="local-6989586621679032489"><a href="#local-6989586621679032489"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032490"><a href="#local-6989586621679032490"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032491"><a href="#local-6989586621679032491"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679032492"><a href="#local-6989586621679032492"><span class="hs-identifier">m'1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#remove"><span class="hs-identifier hs-var">remove</span></a><span> </span><a href="#local-6989586621679032489"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679032490"><span class="hs-identifier hs-var">m1</span></a><span></span><span>
</span><a name="line-354"></a><span class="hs-operator">&gt;</span><span>                                        </span><a name="local-6989586621679032493"><a href="#local-6989586621679032493"><span class="hs-identifier">m'2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#remove"><span class="hs-identifier hs-var">remove</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032489"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032490"><span class="hs-identifier hs-var">m1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032491"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-355"></a><span class="hs-operator">&gt;</span><span>                                   </span><span class="hs-keyword">in</span><span>   </span><a href="#local-6989586621679032492"><span class="hs-identifier hs-var">m'1</span></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="#local-6989586621679032493"><span class="hs-identifier hs-var">m'2</span></a><span></span><span>
</span><a name="line-356"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">remove</span><span> </span><a name="local-6989586621679032494"><a href="#local-6989586621679032494"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Tempo"><span class="hs-identifier hs-var">Tempo</span></a><span> </span><a name="local-6989586621679032495"><a href="#local-6989586621679032495"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032496"><a href="#local-6989586621679032496"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#tempo"><span class="hs-identifier hs-var">tempo</span></a><span> </span><a href="#local-6989586621679032495"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#remove"><span class="hs-identifier hs-var">remove</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032494"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679032495"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032496"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-357"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">remove</span><span> </span><a name="local-6989586621679032497"><a href="#local-6989586621679032497"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a name="local-6989586621679032498"><a href="#local-6989586621679032498"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679032499"><a href="#local-6989586621679032499"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a href="#local-6989586621679032498"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#remove"><span class="hs-identifier hs-var">remove</span></a><span> </span><a href="#local-6989586621679032497"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679032499"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-358"></a><span></span><span>
</span><a name="line-359"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">removeZeros</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030934"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030934"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-360"></a><span class="hs-operator">&gt;</span><span> </span><a name="removeZeros"><a href="Euterpea.Music.html#removeZeros"><span class="hs-identifier">removeZeros</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><a name="local-6989586621679032500"><a href="#local-6989586621679032500"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><a href="#local-6989586621679032500"><span class="hs-identifier hs-var">p</span></a><span></span><span>
</span><a name="line-361"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">removeZeros</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032501"><a href="#local-6989586621679032501"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032502"><a href="#local-6989586621679032502"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-362"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679032503"><a href="#local-6989586621679032503"><span class="hs-identifier">m'1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#removeZeros"><span class="hs-identifier hs-var">removeZeros</span></a><span> </span><a href="#local-6989586621679032501"><span class="hs-identifier hs-var">m1</span></a><span></span><span>
</span><a name="line-363"></a><span class="hs-operator">&gt;</span><span>        </span><a name="local-6989586621679032504"><a href="#local-6989586621679032504"><span class="hs-identifier">m'2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#removeZeros"><span class="hs-identifier hs-var">removeZeros</span></a><span> </span><a href="#local-6989586621679032502"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-364"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032503"><span class="hs-identifier hs-var">m'1</span></a><span class="hs-special">,</span><a href="#local-6989586621679032504"><span class="hs-identifier hs-var">m'2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-365"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679032505"><a href="#local-6989586621679032505"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679032506"><a href="#local-6989586621679032506"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032506"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-366"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679032507"><a href="#local-6989586621679032507"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032507"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-367"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">(</span><a name="local-6989586621679032508"><a href="#local-6989586621679032508"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span> </span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679032509"><a href="#local-6989586621679032509"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032508"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-368"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">(</span><a name="local-6989586621679032510"><a href="#local-6989586621679032510"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span> </span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032510"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-369"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">(</span><a name="local-6989586621679032511"><a href="#local-6989586621679032511"><span class="hs-identifier">m1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679032512"><a href="#local-6989586621679032512"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032511"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="#local-6989586621679032512"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-370"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">removeZeros</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032513"><a href="#local-6989586621679032513"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a name="local-6989586621679032514"><a href="#local-6989586621679032514"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-371"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679032515"><a href="#local-6989586621679032515"><span class="hs-identifier">m'1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#removeZeros"><span class="hs-identifier hs-var">removeZeros</span></a><span> </span><a href="#local-6989586621679032513"><span class="hs-identifier hs-var">m1</span></a><span></span><span>
</span><a name="line-372"></a><span class="hs-operator">&gt;</span><span>        </span><a name="local-6989586621679032516"><a href="#local-6989586621679032516"><span class="hs-identifier">m'2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#removeZeros"><span class="hs-identifier hs-var">removeZeros</span></a><span> </span><a href="#local-6989586621679032514"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-373"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032515"><span class="hs-identifier hs-var">m'1</span></a><span class="hs-special">,</span><a href="#local-6989586621679032516"><span class="hs-identifier hs-var">m'2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-374"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679032517"><a href="#local-6989586621679032517"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679032518"><a href="#local-6989586621679032518"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032518"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-375"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679032519"><a href="#local-6989586621679032519"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032519"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-376"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">(</span><a name="local-6989586621679032520"><a href="#local-6989586621679032520"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span> </span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679032521"><a href="#local-6989586621679032521"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032520"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-377"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">(</span><a name="local-6989586621679032522"><a href="#local-6989586621679032522"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span> </span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032522"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-378"></a><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">(</span><a name="local-6989586621679032523"><a href="#local-6989586621679032523"><span class="hs-identifier">m1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679032524"><a href="#local-6989586621679032524"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032523"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a href="#local-6989586621679032524"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-379"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">removeZeros</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a name="local-6989586621679032525"><a href="#local-6989586621679032525"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679032526"><a href="#local-6989586621679032526"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a href="#local-6989586621679032525"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#removeZeros"><span class="hs-identifier hs-var">removeZeros</span></a><span> </span><a href="#local-6989586621679032526"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-380"></a><span></span><span>
</span><a name="line-381"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">type</span><span> </span><a name="LazyDur"><a href="Euterpea.Music.html#LazyDur"><span class="hs-identifier">LazyDur</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-382"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">durL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030933"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#LazyDur"><span class="hs-identifier hs-type">LazyDur</span></a><span></span><span>
</span><a name="line-383"></a><span class="hs-operator">&gt;</span><span> </span><a name="durL"><a href="Euterpea.Music.html#durL"><span class="hs-identifier">durL</span></a></a><span> </span><a name="local-6989586621679032527"><a href="#local-6989586621679032527"><span class="hs-identifier">m</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032527"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-384"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">durL</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032528"><a href="#local-6989586621679032528"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032529"><a href="#local-6989586621679032529"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032530"><a href="#local-6989586621679032530"><span class="hs-identifier">d1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#durL"><span class="hs-identifier hs-var">durL</span></a><span> </span><a href="#local-6989586621679032528"><span class="hs-identifier hs-var">m1</span></a><span></span><span>
</span><a name="line-385"></a><span class="hs-operator">&gt;</span><span>                               </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679032530"><span class="hs-identifier hs-var">d1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679032530"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#durL"><span class="hs-identifier hs-var">durL</span></a><span> </span><a href="#local-6989586621679032529"><span class="hs-identifier hs-var">m2</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-386"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">durL</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032531"><a href="#local-6989586621679032531"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a name="local-6989586621679032532"><a href="#local-6989586621679032532"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span>  </span><a href="Euterpea.Music.html#mergeLD"><span class="hs-identifier hs-var">mergeLD</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#durL"><span class="hs-identifier hs-var">durL</span></a><span> </span><a href="#local-6989586621679032531"><span class="hs-identifier hs-var">m1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#durL"><span class="hs-identifier hs-var">durL</span></a><span> </span><a href="#local-6989586621679032532"><span class="hs-identifier hs-var">m2</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-387"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">durL</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Tempo"><span class="hs-identifier hs-var">Tempo</span></a><span> </span><a name="local-6989586621679032533"><a href="#local-6989586621679032533"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032534"><a href="#local-6989586621679032534"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679032533"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#durL"><span class="hs-identifier hs-var">durL</span></a><span> </span><a href="#local-6989586621679032534"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-388"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">durL</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679032535"><a href="#local-6989586621679032535"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span>  </span><a href="Euterpea.Music.html#durL"><span class="hs-identifier hs-var">durL</span></a><span> </span><a href="#local-6989586621679032535"><span class="hs-identifier hs-var">m</span></a><span> </span><span>
</span><a name="line-389"></a><span></span><span>
</span><a name="line-390"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">mergeLD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#LazyDur"><span class="hs-identifier hs-type">LazyDur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#LazyDur"><span class="hs-identifier hs-type">LazyDur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#LazyDur"><span class="hs-identifier hs-type">LazyDur</span></a><span></span><span>
</span><a name="line-391"></a><span class="hs-operator">&gt;</span><span> </span><a name="mergeLD"><a href="Euterpea.Music.html#mergeLD"><span class="hs-identifier">mergeLD</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679032536"><a href="#local-6989586621679032536"><span class="hs-identifier">ld</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032536"><span class="hs-identifier hs-var">ld</span></a><span></span><span>
</span><a name="line-392"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">mergeLD</span><span> </span><a name="local-6989586621679032537"><a href="#local-6989586621679032537"><span class="hs-identifier">ld</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032537"><span class="hs-identifier hs-var">ld</span></a><span></span><span>
</span><a name="line-393"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">mergeLD</span><span> </span><a name="local-6989586621679032538"><a href="#local-6989586621679032538"><span class="hs-identifier">ld1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679032539"><a href="#local-6989586621679032539"><span class="hs-identifier">d1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032540"><a href="#local-6989586621679032540"><span class="hs-identifier">ds1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032541"><a href="#local-6989586621679032541"><span class="hs-identifier">ld2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679032542"><a href="#local-6989586621679032542"><span class="hs-identifier">d2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032543"><a href="#local-6989586621679032543"><span class="hs-identifier">ds2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-394"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679032539"><span class="hs-identifier hs-var">d1</span></a><span class="hs-operator hs-var">&lt;</span><a href="#local-6989586621679032542"><span class="hs-identifier hs-var">d2</span></a><span>  </span><span class="hs-keyword">then</span><span>  </span><a href="#local-6989586621679032539"><span class="hs-identifier hs-var">d1</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Euterpea.Music.html#mergeLD"><span class="hs-identifier hs-var">mergeLD</span></a><span> </span><a href="#local-6989586621679032540"><span class="hs-identifier hs-var">ds1</span></a><span> </span><a href="#local-6989586621679032541"><span class="hs-identifier hs-var">ld2</span></a><span></span><span>
</span><a name="line-395"></a><span class="hs-operator">&gt;</span><span>             </span><span class="hs-keyword">else</span><span>  </span><a href="#local-6989586621679032542"><span class="hs-identifier hs-var">d2</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Euterpea.Music.html#mergeLD"><span class="hs-identifier hs-var">mergeLD</span></a><span> </span><a href="#local-6989586621679032538"><span class="hs-identifier hs-var">ld1</span></a><span> </span><a href="#local-6989586621679032543"><span class="hs-identifier hs-var">ds2</span></a><span></span><span>
</span><a name="line-396"></a><span></span><span>
</span><a name="line-397"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">minL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#LazyDur"><span class="hs-identifier hs-type">LazyDur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span></span><span>
</span><a name="line-398"></a><span class="hs-operator">&gt;</span><span> </span><a name="minL"><a href="Euterpea.Music.html#minL"><span class="hs-identifier">minL</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><a name="local-6989586621679032544"><a href="#local-6989586621679032544"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032544"><span class="hs-identifier hs-var">d'</span></a><span></span><span>
</span><a name="line-399"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">minL</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679032545"><a href="#local-6989586621679032545"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span>     </span><a name="local-6989586621679032546"><a href="#local-6989586621679032546"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">min</span><span> </span><a href="#local-6989586621679032545"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679032546"><span class="hs-identifier hs-var">d'</span></a><span></span><span>
</span><a name="line-400"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">minL</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032547"><a href="#local-6989586621679032547"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032548"><a href="#local-6989586621679032548"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621679032549"><a href="#local-6989586621679032549"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679032547"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679032549"><span class="hs-identifier hs-var">d'</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Euterpea.Music.html#minL"><span class="hs-identifier hs-var">minL</span></a><span> </span><a href="#local-6989586621679032548"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679032549"><span class="hs-identifier hs-var">d'</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679032549"><span class="hs-identifier hs-var">d'</span></a><span></span><span>
</span><a name="line-401"></a><span></span><span>
</span><a name="line-402"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cutL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#LazyDur"><span class="hs-identifier hs-type">LazyDur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030932"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030932"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-403"></a><span class="hs-operator">&gt;</span><span> </span><a name="cutL"><a href="Euterpea.Music.html#cutL"><span class="hs-identifier">cutL</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679032550"><a href="#local-6989586621679032550"><span class="hs-identifier">m</span></a></a><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-number">0</span><span></span><span>
</span><a name="line-404"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cutL</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032551"><a href="#local-6989586621679032551"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032552"><a href="#local-6989586621679032552"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032553"><a href="#local-6989586621679032553"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032551"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#cutL"><span class="hs-identifier hs-var">cutL</span></a><span> </span><a href="#local-6989586621679032552"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679032553"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-405"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cutL</span><span> </span><a name="local-6989586621679032554"><a href="#local-6989586621679032554"><span class="hs-identifier">ld</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><a name="local-6989586621679032555"><a href="#local-6989586621679032555"><span class="hs-identifier">oldD</span></a></a><span> </span><a name="local-6989586621679032556"><a href="#local-6989586621679032556"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#minL"><span class="hs-identifier hs-var">minL</span></a><span> </span><a href="#local-6989586621679032554"><span class="hs-identifier hs-var">ld</span></a><span> </span><a href="#local-6989586621679032555"><span class="hs-identifier hs-var">oldD</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032556"><span class="hs-identifier hs-var">p</span></a><span></span><span>
</span><a name="line-406"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cutL</span><span> </span><a name="local-6989586621679032557"><a href="#local-6989586621679032557"><span class="hs-identifier">ld</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><a name="local-6989586621679032558"><a href="#local-6989586621679032558"><span class="hs-identifier">oldD</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#minL"><span class="hs-identifier hs-var">minL</span></a><span> </span><a href="#local-6989586621679032557"><span class="hs-identifier hs-var">ld</span></a><span> </span><a href="#local-6989586621679032558"><span class="hs-identifier hs-var">oldD</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-407"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cutL</span><span> </span><a name="local-6989586621679032559"><a href="#local-6989586621679032559"><span class="hs-identifier">ld</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032560"><a href="#local-6989586621679032560"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a name="local-6989586621679032561"><a href="#local-6989586621679032561"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#cutL"><span class="hs-identifier hs-var">cutL</span></a><span> </span><a href="#local-6989586621679032559"><span class="hs-identifier hs-var">ld</span></a><span> </span><a href="#local-6989586621679032560"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a href="Euterpea.Music.html#cutL"><span class="hs-identifier hs-var">cutL</span></a><span> </span><a href="#local-6989586621679032559"><span class="hs-identifier hs-var">ld</span></a><span> </span><a href="#local-6989586621679032561"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-408"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cutL</span><span> </span><a name="local-6989586621679032562"><a href="#local-6989586621679032562"><span class="hs-identifier">ld</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032563"><a href="#local-6989586621679032563"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032564"><a href="#local-6989586621679032564"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span>
</span><a name="line-409"></a><span class="hs-operator">&gt;</span><span>    </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679032565"><a href="#local-6989586621679032565"><span class="hs-identifier">m'1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#cutL"><span class="hs-identifier hs-var">cutL</span></a><span> </span><a href="#local-6989586621679032562"><span class="hs-identifier hs-var">ld</span></a><span> </span><a href="#local-6989586621679032563"><span class="hs-identifier hs-var">m1</span></a><span></span><span>
</span><a name="line-410"></a><span class="hs-operator">&gt;</span><span>         </span><a name="local-6989586621679032566"><a href="#local-6989586621679032566"><span class="hs-identifier">m'2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#cutL"><span class="hs-identifier hs-var">cutL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679032567"><a href="#local-6989586621679032567"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032567"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Euterpea.Music.html#dur"><span class="hs-identifier hs-var">dur</span></a><span> </span><a href="#local-6989586621679032565"><span class="hs-identifier hs-var">m'1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032562"><span class="hs-identifier hs-var">ld</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032564"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-411"></a><span class="hs-operator">&gt;</span><span>    </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679032565"><span class="hs-identifier hs-var">m'1</span></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="#local-6989586621679032566"><span class="hs-identifier hs-var">m'2</span></a><span></span><span>
</span><a name="line-412"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cutL</span><span> </span><a name="local-6989586621679032568"><a href="#local-6989586621679032568"><span class="hs-identifier">ld</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Tempo"><span class="hs-identifier hs-var">Tempo</span></a><span> </span><a name="local-6989586621679032569"><a href="#local-6989586621679032569"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032570"><a href="#local-6989586621679032570"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#tempo"><span class="hs-identifier hs-var">tempo</span></a><span> </span><a href="#local-6989586621679032569"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#cutL"><span class="hs-identifier hs-var">cutL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679032569"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032568"><span class="hs-identifier hs-var">ld</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032570"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-413"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">cutL</span><span> </span><a name="local-6989586621679032571"><a href="#local-6989586621679032571"><span class="hs-identifier">ld</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a name="local-6989586621679032572"><a href="#local-6989586621679032572"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679032573"><a href="#local-6989586621679032573"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a href="#local-6989586621679032572"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#cutL"><span class="hs-identifier hs-var">cutL</span></a><span> </span><a href="#local-6989586621679032571"><span class="hs-identifier hs-var">ld</span></a><span> </span><a href="#local-6989586621679032573"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-414"></a><span></span><span>
</span><a name="line-415"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">/=:</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030931"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030931"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030931"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-416"></a><span class="hs-operator">&gt;</span><span> </span><a name="local-6989586621679032574"><a href="#local-6989586621679032574"><span class="hs-identifier">m1</span></a></a><span> </span><a name="%2F%3D%3A"><a href="Euterpea.Music.html#%2F%3D%3A"><span class="hs-operator">/=:</span></a></a><span> </span><a name="local-6989586621679032575"><a href="#local-6989586621679032575"><span class="hs-identifier">m2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#cutL"><span class="hs-identifier hs-var">cutL</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#durL"><span class="hs-identifier hs-var">durL</span></a><span> </span><a href="#local-6989586621679032575"><span class="hs-identifier hs-var">m2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032574"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a href="Euterpea.Music.html#cutL"><span class="hs-identifier hs-var">cutL</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#durL"><span class="hs-identifier hs-var">durL</span></a><span> </span><a href="#local-6989586621679032574"><span class="hs-identifier hs-var">m1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032575"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-417"></a><span></span><span>
</span><a name="line-418"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><a name="PercussionSound"><a href="Euterpea.Music.html#PercussionSound"><span class="hs-identifier">PercussionSound</span></a></a><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-419"></a><span class="hs-operator">&gt;</span><span>         </span><a name="AcousticBassDrum"><a href="Euterpea.Music.html#AcousticBassDrum"><span class="hs-identifier">AcousticBassDrum</span></a></a><span>  </span><span class="hs-comment">--  MIDI Key 35</span><span>
</span><a name="line-420"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="BassDrum1"><a href="Euterpea.Music.html#BassDrum1"><span class="hs-identifier">BassDrum1</span></a></a><span>         </span><span class="hs-comment">--  MIDI Key 36</span><span>
</span><a name="line-421"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="SideStick"><a href="Euterpea.Music.html#SideStick"><span class="hs-identifier">SideStick</span></a></a><span>         </span><span class="hs-comment">--  ...</span><span>
</span><a name="line-422"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="AcousticSnare"><a href="Euterpea.Music.html#AcousticSnare"><span class="hs-identifier">AcousticSnare</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="HandClap"><a href="Euterpea.Music.html#HandClap"><span class="hs-identifier">HandClap</span></a></a><span>      </span><span class="hs-glyph">|</span><span> </span><a name="ElectricSnare"><a href="Euterpea.Music.html#ElectricSnare"><span class="hs-identifier">ElectricSnare</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LowFloorTom"><a href="Euterpea.Music.html#LowFloorTom"><span class="hs-identifier">LowFloorTom</span></a></a><span></span><span>
</span><a name="line-423"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="ClosedHiHat"><a href="Euterpea.Music.html#ClosedHiHat"><span class="hs-identifier">ClosedHiHat</span></a></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="HighFloorTom"><a href="Euterpea.Music.html#HighFloorTom"><span class="hs-identifier">HighFloorTom</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="PedalHiHat"><a href="Euterpea.Music.html#PedalHiHat"><span class="hs-identifier">PedalHiHat</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><a name="LowTom"><a href="Euterpea.Music.html#LowTom"><span class="hs-identifier">LowTom</span></a></a><span></span><span>
</span><a name="line-424"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="OpenHiHat"><a href="Euterpea.Music.html#OpenHiHat"><span class="hs-identifier">OpenHiHat</span></a></a><span>      </span><span class="hs-glyph">|</span><span> </span><a name="LowMidTom"><a href="Euterpea.Music.html#LowMidTom"><span class="hs-identifier">LowMidTom</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><a name="HiMidTom"><a href="Euterpea.Music.html#HiMidTom"><span class="hs-identifier">HiMidTom</span></a></a><span>       </span><span class="hs-glyph">|</span><span> </span><a name="CrashCymbal1"><a href="Euterpea.Music.html#CrashCymbal1"><span class="hs-identifier">CrashCymbal1</span></a></a><span></span><span>
</span><a name="line-425"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="HighTom"><a href="Euterpea.Music.html#HighTom"><span class="hs-identifier">HighTom</span></a></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="RideCymbal1"><a href="Euterpea.Music.html#RideCymbal1"><span class="hs-identifier">RideCymbal1</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="ChineseCymbal"><a href="Euterpea.Music.html#ChineseCymbal"><span class="hs-identifier">ChineseCymbal</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RideBell"><a href="Euterpea.Music.html#RideBell"><span class="hs-identifier">RideBell</span></a></a><span></span><span>
</span><a name="line-426"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="Tambourine"><a href="Euterpea.Music.html#Tambourine"><span class="hs-identifier">Tambourine</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><a name="SplashCymbal"><a href="Euterpea.Music.html#SplashCymbal"><span class="hs-identifier">SplashCymbal</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Cowbell"><a href="Euterpea.Music.html#Cowbell"><span class="hs-identifier">Cowbell</span></a></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="CrashCymbal2"><a href="Euterpea.Music.html#CrashCymbal2"><span class="hs-identifier">CrashCymbal2</span></a></a><span></span><span>
</span><a name="line-427"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="Vibraslap"><a href="Euterpea.Music.html#Vibraslap"><span class="hs-identifier">Vibraslap</span></a></a><span>      </span><span class="hs-glyph">|</span><span> </span><a name="RideCymbal2"><a href="Euterpea.Music.html#RideCymbal2"><span class="hs-identifier">RideCymbal2</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="HiBongo"><a href="Euterpea.Music.html#HiBongo"><span class="hs-identifier">HiBongo</span></a></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="LowBongo"><a href="Euterpea.Music.html#LowBongo"><span class="hs-identifier">LowBongo</span></a></a><span></span><span>
</span><a name="line-428"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="MuteHiConga"><a href="Euterpea.Music.html#MuteHiConga"><span class="hs-identifier">MuteHiConga</span></a></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="OpenHiConga"><a href="Euterpea.Music.html#OpenHiConga"><span class="hs-identifier">OpenHiConga</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="LowConga"><a href="Euterpea.Music.html#LowConga"><span class="hs-identifier">LowConga</span></a></a><span>       </span><span class="hs-glyph">|</span><span> </span><a name="HighTimbale"><a href="Euterpea.Music.html#HighTimbale"><span class="hs-identifier">HighTimbale</span></a></a><span></span><span>
</span><a name="line-429"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="LowTimbale"><a href="Euterpea.Music.html#LowTimbale"><span class="hs-identifier">LowTimbale</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><a name="HighAgogo"><a href="Euterpea.Music.html#HighAgogo"><span class="hs-identifier">HighAgogo</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><a name="LowAgogo"><a href="Euterpea.Music.html#LowAgogo"><span class="hs-identifier">LowAgogo</span></a></a><span>       </span><span class="hs-glyph">|</span><span> </span><a name="Cabasa"><a href="Euterpea.Music.html#Cabasa"><span class="hs-identifier">Cabasa</span></a></a><span></span><span>
</span><a name="line-430"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="Maracas"><a href="Euterpea.Music.html#Maracas"><span class="hs-identifier">Maracas</span></a></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="ShortWhistle"><a href="Euterpea.Music.html#ShortWhistle"><span class="hs-identifier">ShortWhistle</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LongWhistle"><a href="Euterpea.Music.html#LongWhistle"><span class="hs-identifier">LongWhistle</span></a></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="ShortGuiro"><a href="Euterpea.Music.html#ShortGuiro"><span class="hs-identifier">ShortGuiro</span></a></a><span></span><span>
</span><a name="line-431"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="LongGuiro"><a href="Euterpea.Music.html#LongGuiro"><span class="hs-identifier">LongGuiro</span></a></a><span>      </span><span class="hs-glyph">|</span><span> </span><a name="Claves"><a href="Euterpea.Music.html#Claves"><span class="hs-identifier">Claves</span></a></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="HiWoodBlock"><a href="Euterpea.Music.html#HiWoodBlock"><span class="hs-identifier">HiWoodBlock</span></a></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="LowWoodBlock"><a href="Euterpea.Music.html#LowWoodBlock"><span class="hs-identifier">LowWoodBlock</span></a></a><span></span><span>
</span><a name="line-432"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="MuteCuica"><a href="Euterpea.Music.html#MuteCuica"><span class="hs-identifier">MuteCuica</span></a></a><span>      </span><span class="hs-glyph">|</span><span> </span><a name="OpenCuica"><a href="Euterpea.Music.html#OpenCuica"><span class="hs-identifier">OpenCuica</span></a></a><span>     </span><span class="hs-glyph">|</span><span> </span><a name="MuteTriangle"><a href="Euterpea.Music.html#MuteTriangle"><span class="hs-identifier">MuteTriangle</span></a></a><span></span><span>
</span><a name="line-433"></a><span class="hs-operator">&gt;</span><span>      </span><span class="hs-glyph">|</span><span>  </span><a name="OpenTriangle"><a href="Euterpea.Music.html#OpenTriangle"><span class="hs-identifier">OpenTriangle</span></a></a><span>      </span><span class="hs-comment">--  MIDI Key 82</span><span>
</span><a name="line-434"></a><span class="hs-operator">&gt;</span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-435"></a><span></span><span>
</span><a name="line-436"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">perc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#PercussionSound"><span class="hs-identifier hs-type">PercussionSound</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Dur"><span class="hs-identifier hs-type">Dur</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span></span><span>
</span><a name="line-437"></a><span class="hs-operator">&gt;</span><span> </span><a name="perc"><a href="Euterpea.Music.html#perc"><span class="hs-identifier">perc</span></a></a><span> </span><a name="local-6989586621679032576"><a href="#local-6989586621679032576"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621679032577"><a href="#local-6989586621679032577"><span class="hs-identifier">dur</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#instrument"><span class="hs-identifier hs-var">instrument</span></a><span> </span><a href="Euterpea.Music.html#Percussion"><span class="hs-identifier hs-var">Percussion</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><a href="#local-6989586621679032577"><span class="hs-identifier hs-var">dur</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#pitch"><span class="hs-identifier hs-var">pitch</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679032576"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">35</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-438"></a><span></span><span>
</span><a name="line-439"></a><span></span><span>
</span><a name="line-440"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">pMap</span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030929"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030930"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a><span> </span><a href="#local-6989586621679030929"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a><span> </span><a href="#local-6989586621679030930"><span class="hs-identifier hs-type">b</span></a><span></span><span>
</span><a name="line-441"></a><span class="hs-operator">&gt;</span><span> </span><a name="pMap"><a href="Euterpea.Music.html#pMap"><span class="hs-identifier">pMap</span></a></a><span> </span><a name="local-6989586621679032578"><a href="#local-6989586621679032578"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><a name="local-6989586621679032579"><a href="#local-6989586621679032579"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679032580"><a href="#local-6989586621679032580"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><a href="#local-6989586621679032579"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032578"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032580"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-442"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">pMap</span><span> </span><a name="local-6989586621679032581"><a href="#local-6989586621679032581"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><a name="local-6989586621679032582"><a href="#local-6989586621679032582"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><a href="#local-6989586621679032582"><span class="hs-identifier hs-var">d</span></a><span></span><span>
</span><a name="line-443"></a><span></span><span>
</span><a name="line-444"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">mMap</span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030927"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030928"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030927"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030928"><span class="hs-identifier hs-type">b</span></a><span></span><span>
</span><a name="line-445"></a><span class="hs-operator">&gt;</span><span> </span><a name="mMap"><a href="Euterpea.Music.html#mMap"><span class="hs-identifier">mMap</span></a></a><span> </span><a name="local-6989586621679032583"><a href="#local-6989586621679032583"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><a name="local-6989586621679032584"><a href="#local-6989586621679032584"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#pMap"><span class="hs-identifier hs-var">pMap</span></a><span> </span><a href="#local-6989586621679032583"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032584"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-446"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">mMap</span><span> </span><a name="local-6989586621679032585"><a href="#local-6989586621679032585"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032586"><a href="#local-6989586621679032586"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032587"><a href="#local-6989586621679032587"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><a href="#local-6989586621679032585"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032586"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><a href="#local-6989586621679032585"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032587"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-447"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">mMap</span><span> </span><a name="local-6989586621679032588"><a href="#local-6989586621679032588"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032589"><a href="#local-6989586621679032589"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a name="local-6989586621679032590"><a href="#local-6989586621679032590"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><a href="#local-6989586621679032588"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032589"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><a href="#local-6989586621679032588"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032590"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-448"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">mMap</span><span> </span><a name="local-6989586621679032591"><a href="#local-6989586621679032591"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a name="local-6989586621679032592"><a href="#local-6989586621679032592"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679032593"><a href="#local-6989586621679032593"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a href="#local-6989586621679032592"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><a href="#local-6989586621679032591"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032593"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-449"></a><span></span><span>
</span><a name="line-450"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="Euterpea.Music.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-451"></a><span class="hs-operator">&gt;</span><span>     </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#pMap"><span class="hs-identifier hs-var">pMap</span></a><span></span><span>
</span><a name="line-452"></a><span></span><span>
</span><a name="line-453"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-454"></a><span class="hs-operator">&gt;</span><span>     </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span></span><span>
</span><a name="line-455"></a><span></span><span>
</span><a name="line-456"></a><span></span><span>
</span><a name="line-457"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">mFold</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a><span> </span><a href="#local-6989586621679030925"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030926"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030926"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679030926"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679030926"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030926"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679030926"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679030926"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><a name="line-458"></a><span class="hs-operator">&gt;</span><span>           </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Control"><span class="hs-identifier hs-type">Control</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030926"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030926"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030925"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030926"><span class="hs-identifier hs-type">b</span></a><span></span><span>
</span><a name="line-459"></a><span class="hs-operator">&gt;</span><span> </span><a name="mFold"><a href="Euterpea.Music.html#mFold"><span class="hs-identifier">mFold</span></a></a><span> </span><a name="local-6989586621679032594"><a href="#local-6989586621679032594"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032595"><a href="#local-6989586621679032595"><span class="hs-operator">+:</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032596"><a href="#local-6989586621679032596"><span class="hs-operator">=:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032597"><a href="#local-6989586621679032597"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679032598"><a href="#local-6989586621679032598"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-460"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032599"><a href="#local-6989586621679032599"><span class="hs-identifier">rec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mFold"><span class="hs-identifier hs-var">mFold</span></a><span> </span><a href="#local-6989586621679032594"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032595"><span class="hs-operator hs-var">+:</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032596"><span class="hs-operator hs-var">=:</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032597"><span class="hs-identifier hs-var">g</span></a><span></span><span>
</span><a name="line-461"></a><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679032598"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-462"></a><span class="hs-operator">&gt;</span><span>        </span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><a name="local-6989586621679032600"><a href="#local-6989586621679032600"><span class="hs-identifier">p</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032594"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032600"><span class="hs-identifier hs-var">p</span></a><span></span><span>
</span><a name="line-463"></a><span class="hs-operator">&gt;</span><span>        </span><a name="local-6989586621679032601"><a href="#local-6989586621679032601"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032602"><a href="#local-6989586621679032602"><span class="hs-identifier">m2</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032599"><span class="hs-identifier hs-var">rec</span></a><span> </span><a href="#local-6989586621679032601"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679032595"><span class="hs-operator hs-var">+:</span></a><span> </span><a href="#local-6989586621679032599"><span class="hs-identifier hs-var">rec</span></a><span> </span><a href="#local-6989586621679032602"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-464"></a><span class="hs-operator">&gt;</span><span>        </span><a name="local-6989586621679032603"><a href="#local-6989586621679032603"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a name="local-6989586621679032604"><a href="#local-6989586621679032604"><span class="hs-identifier">m2</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032599"><span class="hs-identifier hs-var">rec</span></a><span> </span><a href="#local-6989586621679032603"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679032596"><span class="hs-operator hs-var">=:</span></a><span> </span><a href="#local-6989586621679032599"><span class="hs-identifier hs-var">rec</span></a><span> </span><a href="#local-6989586621679032604"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-465"></a><span class="hs-operator">&gt;</span><span>        </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a name="local-6989586621679032605"><a href="#local-6989586621679032605"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679032606"><a href="#local-6989586621679032606"><span class="hs-identifier">m</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032597"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679032605"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032599"><span class="hs-identifier hs-var">rec</span></a><span> </span><a href="#local-6989586621679032606"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-466"></a><span></span><span>
</span><a name="line-467"></a><span></span><span>
</span><a name="line-468"></a><span class="hs-comment">-- =========================================================================================</span><span>
</span><a name="line-469"></a><span></span><span>
</span><a name="line-470"></a><span class="hs-identifier">Sometimes</span><span> </span><span class="hs-identifier">we</span><span> </span><span class="hs-identifier">may</span><span> </span><span class="hs-identifier">wish</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">alter</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">internal</span><span> </span><span class="hs-identifier">structure</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">Music</span><span> </span><span class="hs-identifier">value</span><span></span><span>
</span><a name="line-471"></a><span class="hs-identifier">rather</span><span> </span><span class="hs-identifier">than</span><span> </span><span class="hs-identifier">wrapping</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">Modify</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">The</span><span> </span><span class="hs-identifier">following</span><span> </span><span class="hs-identifier">functions</span><span> </span><span class="hs-identifier">allow</span><span> </span><span class="hs-identifier">this</span><span class="hs-operator">.</span><span></span><span>
</span><a name="line-472"></a><span></span><span>
</span><a name="line-473"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">shiftPitches</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#AbsPitch"><span class="hs-identifier hs-type">AbsPitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span></span><span>
</span><a name="line-474"></a><span class="hs-operator">&gt;</span><span> </span><a name="shiftPitches"><a href="Euterpea.Music.html#shiftPitches"><span class="hs-identifier">shiftPitches</span></a></a><span> </span><a name="local-6989586621679032607"><a href="#local-6989586621679032607"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#trans"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679032607"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-475"></a><span></span><span>
</span><a name="line-476"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">shiftPitches1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#AbsPitch"><span class="hs-identifier hs-type">AbsPitch</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679030924"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Pitch"><span class="hs-identifier hs-type">Pitch</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679030924"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-477"></a><span class="hs-operator">&gt;</span><span> </span><a name="shiftPitches1"><a href="Euterpea.Music.html#shiftPitches1"><span class="hs-identifier">shiftPitches1</span></a></a><span> </span><a name="local-6989586621679032608"><a href="#local-6989586621679032608"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#mMap"><span class="hs-identifier hs-var">mMap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679032609"><a href="#local-6989586621679032609"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032610"><a href="#local-6989586621679032610"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#trans"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679032608"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679032609"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032610"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-478"></a><span></span><span>
</span><a name="line-479"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">scaleDurations</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030923"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030923"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-480"></a><span class="hs-operator">&gt;</span><span> </span><a name="scaleDurations"><a href="Euterpea.Music.html#scaleDurations"><span class="hs-identifier">scaleDurations</span></a></a><span> </span><a name="local-6989586621679032611"><a href="#local-6989586621679032611"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Note"><span class="hs-identifier hs-var">Note</span></a><span> </span><a name="local-6989586621679032612"><a href="#local-6989586621679032612"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679032613"><a href="#local-6989586621679032613"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#note"><span class="hs-identifier hs-var">note</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032612"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679032611"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032613"><span class="hs-identifier hs-var">p</span></a><span></span><span>
</span><a name="line-481"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">scaleDurations</span><span> </span><a name="local-6989586621679032614"><a href="#local-6989586621679032614"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Prim"><span class="hs-identifier hs-var">Prim</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Rest"><span class="hs-identifier hs-var">Rest</span></a><span> </span><a name="local-6989586621679032615"><a href="#local-6989586621679032615"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#rest"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032615"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679032614"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-482"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">scaleDurations</span><span> </span><a name="local-6989586621679032616"><a href="#local-6989586621679032616"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032617"><a href="#local-6989586621679032617"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032618"><a href="#local-6989586621679032618"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#scaleDurations"><span class="hs-identifier hs-var">scaleDurations</span></a><span> </span><a href="#local-6989586621679032616"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679032617"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="Euterpea.Music.html#scaleDurations"><span class="hs-identifier hs-var">scaleDurations</span></a><span> </span><a href="#local-6989586621679032616"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679032618"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-483"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">scaleDurations</span><span> </span><a name="local-6989586621679032619"><a href="#local-6989586621679032619"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032620"><a href="#local-6989586621679032620"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a name="local-6989586621679032621"><a href="#local-6989586621679032621"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#scaleDurations"><span class="hs-identifier hs-var">scaleDurations</span></a><span> </span><a href="#local-6989586621679032619"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679032620"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a href="Euterpea.Music.html#scaleDurations"><span class="hs-identifier hs-var">scaleDurations</span></a><span> </span><a href="#local-6989586621679032619"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679032621"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-484"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">scaleDurations</span><span> </span><a name="local-6989586621679032622"><a href="#local-6989586621679032622"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a name="local-6989586621679032623"><a href="#local-6989586621679032623"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679032624"><a href="#local-6989586621679032624"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a href="#local-6989586621679032623"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#scaleDurations"><span class="hs-identifier hs-var">scaleDurations</span></a><span> </span><a href="#local-6989586621679032622"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679032624"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-485"></a><span></span><span>
</span><a name="line-486"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">changeInstrument</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#InstrumentName"><span class="hs-identifier hs-type">InstrumentName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030922"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030922"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-487"></a><span class="hs-operator">&gt;</span><span> </span><a name="changeInstrument"><a href="Euterpea.Music.html#changeInstrument"><span class="hs-identifier">changeInstrument</span></a></a><span> </span><a name="local-6989586621679032625"><a href="#local-6989586621679032625"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679032626"><a href="#local-6989586621679032626"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Instrument"><span class="hs-identifier hs-var">Instrument</span></a><span> </span><a href="#local-6989586621679032625"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Euterpea.Music.html#removeInstruments"><span class="hs-identifier hs-var">removeInstruments</span></a><span> </span><a href="#local-6989586621679032626"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-488"></a><span></span><span>
</span><a name="line-489"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">removeInstruments</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030921"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Euterpea.Music.html#Music"><span class="hs-identifier hs-type">Music</span></a><span> </span><a href="#local-6989586621679030921"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-490"></a><span class="hs-operator">&gt;</span><span> </span><a name="removeInstruments"><a href="Euterpea.Music.html#removeInstruments"><span class="hs-identifier">removeInstruments</span></a></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Instrument"><span class="hs-identifier hs-var">Instrument</span></a><span> </span><a name="local-6989586621679032627"><a href="#local-6989586621679032627"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032628"><a href="#local-6989586621679032628"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#removeInstruments"><span class="hs-identifier hs-var">removeInstruments</span></a><span> </span><a href="#local-6989586621679032628"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-491"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">removeInstruments</span><span> </span><span class="hs-special">(</span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a name="local-6989586621679032629"><a href="#local-6989586621679032629"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679032630"><a href="#local-6989586621679032630"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#Modify"><span class="hs-identifier hs-var">Modify</span></a><span> </span><a href="#local-6989586621679032629"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Euterpea.Music.html#removeInstruments"><span class="hs-identifier hs-var">removeInstruments</span></a><span> </span><a href="#local-6989586621679032630"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-492"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">removeInstruments</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032631"><a href="#local-6989586621679032631"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a name="local-6989586621679032632"><a href="#local-6989586621679032632"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#removeInstruments"><span class="hs-identifier hs-var">removeInstruments</span></a><span> </span><a href="#local-6989586621679032631"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%2B%3A"><span class="hs-operator hs-var">:+:</span></a><span> </span><a href="Euterpea.Music.html#removeInstruments"><span class="hs-identifier hs-var">removeInstruments</span></a><span> </span><a href="#local-6989586621679032632"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-493"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">removeInstruments</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032633"><a href="#local-6989586621679032633"><span class="hs-identifier">m1</span></a></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a name="local-6989586621679032634"><a href="#local-6989586621679032634"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Euterpea.Music.html#removeInstruments"><span class="hs-identifier hs-var">removeInstruments</span></a><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Euterpea.Music.html#%3A%3D%3A"><span class="hs-operator hs-var">:=:</span></a><span> </span><a href="Euterpea.Music.html#removeInstruments"><span class="hs-identifier hs-var">removeInstruments</span></a><span> </span><a href="#local-6989586621679032634"><span class="hs-identifier hs-var">m2</span></a><span></span><span>
</span><a name="line-494"></a><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">removeInstruments</span><span> </span><a name="local-6989586621679032635"><a href="#local-6989586621679032635"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">m</span></a><span></span><span>
</span><a name="line-495"></a><span></span><span>
</span><a name="line-496"></a><span></span><span>
</span><a name="line-497"></a><span></span><span>
</span><a name="line-498"></a></pre></body></html>